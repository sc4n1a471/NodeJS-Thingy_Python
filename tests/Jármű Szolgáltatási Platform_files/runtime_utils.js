"use strict";function GetTopFrame(){var a=window;while(a!=a.parent){a=a.parent;if(typeof a.document.body.attributes.snap!=="undefined"){return a}}return null}var g_TopFrame=GetTopFrame();var g_LocalizedStrings=g_TopFrame.g_Localization[g_TopFrame.g_defaultLanguage];var g_IsRequiredField=g_LocalizedStrings.REQUIRED_FIELD;var g_DateTimeSettings=g_LocalizedStrings;if(g_TopFrame.DoHotkeydown){$("html").on("keydown",g_TopFrame.DoHotkeydown)}function SnapSysError(b,a){RunTimeError("Internal error: "+b,a)}function RunTimeError(c,a){c+="\n"+(new Error()).stack.toString();var b=(c||"")+(a?(" "+a.toString()):"");if(typeof g_TopFrame.g_errorLog==="string"){g_TopFrame.g_errorLog+=(g_TopFrame.g_errorLog?"\n":"")+b}if(!g_TopFrame.testThread){DoConsoleLog(c,a)}}function AjaxError(a,b,d,c){RunTimeError(a+": "+JSON.stringify(c)+" "+d+": "+JSON.stringify(b))}function DoConsoleLog(b,a){if(g_TopFrame&&g_TopFrame.DoConsoleLog){g_TopFrame.DoConsoleLog(b,a)}}function DoConsoleTable(b,a,c){if(g_TopFrame&&g_TopFrame.DoConsoleTable){g_TopFrame.DoConsoleTable(b,a,c)}}(function(a){a.fn.bindWithDelay=function(c,f,b,e,d){if(a.isFunction(f)){d=e;e=b;b=f;f=undefined}b.guid=b.guid||(a.guid&&a.guid++);return this.each(function(){var h=null;function g(){var k=a.extend(true,{},arguments[0]);var j=this;var l=function(){h=null;b.apply(j,[k])};if(!d){clearTimeout(h);h=null}if(!h){h=setTimeout(l,e)}}g.guid=b.guid;a(this).bind(c,f,g)})}})(jQuery);var g_lastShortcutKeyEvent=0;function PerformClickOnShortcut(c,a){if(g_lastShortcutKeyEvent==a.timeStamp){return}g_lastShortcutKeyEvent=a.timeStamp;if($("[role=dialog]:visible").length){return}var b=$(".shortcut-class-"+c+":visible:not(.disabled)");if(b.length==1){b[0].click();a.preventDefault()}else{if(b.length>1){RunTimeError(b.length+" targets for keypress "+c+", none clicked.")}}}function MessageDialog(c,f,g,e,d){function b(h){return function(j){h.apply(this,arguments)}}var a=$("#"+c);d=$.extend({},{onOK:null,onYes:null,onNo:null,onCancel:null},d);a.find(".okButton").toggle($.isFunction(d.onOK));a.find(".yesButton").toggle($.isFunction(d.onYes));a.find(".noButton").toggle($.isFunction(d.onNo));a.find(".cancelButton").toggle($.isFunction(d.onCancel));a.find(".okButton").off("click").on({click:b(d.onOK)});a.find(".yesButton").off("click").on({click:b(d.onYes)});a.find(".noButton").off("click").on({click:b(d.onNo)});a.find(".cancelButton").off("click").on({click:b(d.onCancel)});if(f){a.find(".dlg_caption").text(f)}if(g){a.find(".dlg_title").text(g)}if(e){a.find(".dlg_text").text(e)}a.popup("open")}function MessageDlg(n,o,k,c,j,r,f,w){var g=$("#mydivpopup");if(g.hasClass("in")){return}j=$.extend({},{onOK:null,onCancel:null,onYes:null,onNo:null},j);r=$.extend({},{btnOK:"OK",btnCancel:"Cancel",btnYes:"Yes",btnNo:"No"},r);var b=$(g_TopFrame.document).find("body");var x=!$(b).find("#covering")[0];var u=$('<div class="modal" role="dialog" aria-labelledby="mydivpopup" id="mydivpopup"></div>');var t=$('<div class="modal-dialog"></div>').appendTo(u);var m=$('<div class="modal-content"></div>').appendTo(t);var s=$('<div class="modal-header"></div>');if(n||o){if(n){$('<h4 class="modal-title text-center"></h4>').text(n).appendTo(s)}if(o){$('<h2 class="modal-title"></h2>').text(o).appendTo(s)}s.appendTo(m)}if(w){m.addClass("panel").addClass("panel-"+w);s.addClass("panel-heading")}var e="";$.each((k||"").replace("\r","\n").split("\n"),function(y,A){var z=$("<p></p>").text(A);if(y!=0){e+="<br>"}e+=z.html();z.remove()});var v=$('<div class="modal-body"></div>');if(f&&(typeof f==="string")&&f.match(/^[0-9]+$/)){var a=$('<div class="media"></div>');var d=$('<div class="media-left"></div>');var h=$('<div class="media-body media-middle"></div>').html(e);$('<img id="dlg-image-1" alt="image">').attr("src","get_image.php?img="+f).appendTo(d);d.appendTo(a);h.appendTo(a);a.appendTo(v)}else{$("<p></p>").html(e).appendTo(v)}v.appendTo(m);var l=$('<div class="modal-footer"></div>');if(c!="X"){l.appendTo(m)}if(x){g.remove();$("body").append(u)}else{$("<style>"+GetStylesheetsToCopy()+"</style>").appendTo(u);b.find("#mydivpopup").remove();b.append(u)}if(c.indexOf("O")>-1){$("<button>",{text:r.btnOK,type:"button","class":"btn btn-default","data-dismiss":"modal"}).attr("id","snap-dialog-ok-button").on("click",function(){setTimeout(j.onOK,100)}).appendTo(l)}if(c.indexOf("C")>-1){$("<button>",{text:r.btnCancel,type:"button","class":"btn btn-default","data-dismiss":"modal"}).attr("id","snap-dialog-cancel-button").on("click",function(){setTimeout(j.onCancel,100)}).appendTo(l)}if(c.indexOf("Y")>-1){$("<button>",{text:r.btnYes,type:"button","class":"btn btn-default","data-dismiss":"modal"}).attr("id","snap-dialog-yes-button").on("click",function(){setTimeout(j.onYes,100)}).appendTo(l)}if(c.indexOf("N")>-1){$("<button>",{text:r.btnNo,type:"button","class":"btn btn-default","data-dismiss":"modal"}).attr("id","snap-dialog-no-button").on("click",function(){setTimeout(j.onNo,100)}).appendTo(l)}if(x){g.on("shown.bs.modal",function(){$(this).find("button:first").focus()});g.modal({backdrop:"static",keyboard:false,show:true})}else{var q=b.find("#mydivpopup");q.on("shown.bs.modal",function(){$(this).find("button:first").focus();b.find("#covering").addClass("active")});q.modal({backdrop:false,keyboard:false,show:true});q.on("hidden.bs.modal",function(){q.remove();b.find("#covering").removeClass("active")})}}function CloseMessageDlg(){var a=$(g_TopFrame.document).find("body");var c=!$(a).find("#covering")[0];if(c){$("#mydivpopup").modal("hide")}else{var b=a.find("#mydivpopup");b.modal("hide")}}function HelpMessageDlg(f){var c=$(g_TopFrame.document).find("body");var d=!$(c).find("#covering")[0];var h=$("#"+f);var b=$('label[for="'+f+'"]').text();var g;if(h.is("[data-help-text]")){g=h.attr("data-help-text");g=ParseHelpText(g,f)}else{if(h.is("[data-help-doc]")){var a=h.attr("data-help-doc");var e=h.attr("data-help-section");g=DoGetHelp(a,{});g=ParseDocHelpText(g,e,f)}else{return}}if(!d){var j=c.find("#help-dialog");j.find(".modal-body").html(g);j.find("#help-title").text(b);j.modal({backdrop:false,keyboard:false,show:false});j.modal("show")}}function ParseHelpText(b,c){b=$("<div/>").text(b).html();var a=($("#"+c).is("[readonly]")||$("#"+c).is("[disabled]"))?false:true;if(a){return b.replace(/\*([^*]+)\*/g,"<a onclick=\"SetControlFromHelp('"+c+"','"+GetCurrentFrameID("X")+"','$1')\" data-dismiss=\"modal\">$1</a>")}else{return b.replace(/\*([^*]+)\*/g,'<a onclick="javascript: return;" >$1</a>')}}function ParseDocHelpText(d,a,e){var c=($("#"+e).is("[readonly]")||$("#"+e).is("[disabled]"))?false:true;if(a!=""){var b=d.indexOf("@@"+a+"@@");if(b==-1){throw'Help Error: section "'+a+'" not found in the provided help document!'}d=d.substr((b)+(a.length)+(4));if(d.indexOf("@@")!=-1){d=d.substr(0,d.indexOf("@@"))}}if(c){return d.replace(/\*([^*]+)\*/g,"<a onclick=\"SetControlFromHelp('"+e+"','"+GetCurrentFrameID("X")+"','$1')\" data-dismiss=\"modal\">$1</a>")}else{return d.replace(/\*([^*]+)\*/g,'<a onclick="javascript: return;" >$1</a>')}}function GetElementOfArray(a,b){if(b===null||b===undefined){RunTimeError("No element with index "+a+" in "+JSON.stringify(b));return null}return b[a-1]}function GetFieldOfObject(c,b,d){if(b===null||b===undefined||typeof b!=="object"){RunTimeError(JSON.stringify(b)+" is not a record.");return null}var a=b[c];if(!(c in b)){RunTimeError("No field "+c+" in "+JSON.stringify(b))}if(d){delete b[c]}return a}function CheckIsIn(b,a){if(a===null||a===undefined||typeof a!=="object"){return false}return b in a}function AsBoolean(a){if(a===null||a===undefined){return false}if(a.constructor==Boolean){return a}if(a.constructor==Number){return a!=0}if(a.constructor==String){return a.toLowerCase()=="true"}return false}function MathRoundTo(b,a){var c=Math.pow(10,a);return Math.round(b*c)/c}function MathCeilTo(b,a){var c=Math.pow(10,a);return Math.ceil(b*c)/c}function MathFloorTo(b,a){var c=Math.pow(10,a);return Math.floor(b*c)/c}function CurrentUserIsInGroup(a){return GetUserInfo().groups.indexOf(a)>=0}function ArrayToListView(b,a){var c=$("#"+a);c.empty();$.each(b,function(g,d){var f,h,j;f=$("<li>").addClass("list-group-item");if(d.context){f.addClass("list-group-item-"+d.context)}if(typeof d.image=="string"&&d.image.match(/^[0-9]+$/)&&d.image!=0&&d.image!="0"){h=$("<img>").attr("src","get_image.php?img="+d.image).addClass("img-rounded");if(d.isize){h.addClass(d.isize)}h=$("<div>").addClass("media-left").append(h)}j=$("<div>");if(d.header){j.append($("<h4>").addClass("list-group-item-heading").text(d.header))}if(d.listitem){j.append($("<p>").addClass("list-group-item-text").text(d.listitem))}if(h){f.append($("<div>").addClass("media").append(h).append(j.addClass("media-body")))}else{f.append(j.unwrap())}if(d.link){var e=$("<a>").attr("href","#").attr("id",a+"-listitem-"+g).attr("ctrl_type","listitem").append(f.children());f.empty().append(e)}else{f.attr("id",a+"-listitem-"+g)}if(d.aside){f.prepend($("<span>").addClass("badge").text(d.aside))}c.append(f)})}function ListViewToArray(b){var a=[];b.find("li").each(function(){var d=$(this);var c=null;$.each(cListItemContextClasses,function(f,g){if(d.hasClass(g)){c=g.replace("list-group-item-","")}});a.push({context:c,image:(d.find("img[src]").length>0)?d.find("img").attr("src").replace(/^get_image.php\?img=/,""):null,header:d.find(".list-group-item-heading").text(),listitem:d.find(".list-group-item-text").text(),link:d.find("a").length>0,aside:d.find(".badge").text()})});return a}function SelectMenuOptionsToArray(e){var f=$("#"+e)[0];var c=[],d=0,b=f.length;for(;d<b;d++){var a=$(f[d]);c.push({value:a.attr("value"),selected:a[0].selected,enabled:!a.attr("disabled"),visible:!a.hasClass("hidden"),placeholder:!!a.data("placeholder"),subtext:a.attr("data-subtext"),display:a.text()})}return c}function GetStylesheetsToCopy(){var a="";$.each(document.styleSheets,function(){if(this.href!=null&&this.href.indexOf("get_stylesheet")!=-1){a+=Array.prototype.map.call(this.cssRules,function(b){return b.cssText||""}).join("\n")}});return a}function GetDatePartOf(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)}function GetTimePartOf(a){return new Date(0,0,0,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}function format_dt(d,g,j){var h,e,k;var b=/\\?(.?)/gi;var a=function(f,l){return e[f]?e[f]():l};var c=function(l,f){l=String(l);while(l.length<f){l="0"+l}return l};e={d:function(){return c(e.j(),2)},D:function(){var f=e.w();return $.isArray(g.DAY_SHORT_NAMES)&&undefined!==g.DAY_SHORT_NAMES[f]?g.DAY_SHORT_NAMES[f]:g.days[f].substr(0,3)},j:function(){return h.getDate()},l:function(){return g.DAY_LONG_NAMES[e.w()]},N:function(){return e.w()||7},S:function(){var f=e.j();var l=f%10;if(l<=3&&parseInt((f%100)/10,10)==1){l=0}return["st","nd","rd"][l-1]||"th"},w:function(){return h.getDay()},z:function(){var l=new Date(e.Y(),e.n()-1,e.j());var f=new Date(e.Y(),0,1);return Math.round((l-f)/86400000)},W:function(){var l=new Date(e.Y(),e.n()-1,e.j()-e.N()+3);var f=new Date(l.getFullYear(),0,4);return c(1+Math.round((l-f)/86400000/7),2)},F:function(){return g.MONTH_LONG_NAMES[e.n()-1]},m:function(){return c(e.n(),2)},M:function(){return g.MONTH_SHORT_NAMES[e.n()-1]},n:function(){return h.getMonth()+1},t:function(){return(new Date(e.Y(),e.n(),0)).getDate()},L:function(){var f=e.Y();return(f%4===0&&f%100!==0||f%400===0)?1:0},o:function(){var m=e.n();var f=e.W();var l=e.Y();return l+(m===12&&f<9?1:m===1&&f>9?-1:0)},Y:function(){return h.getFullYear()},y:function(){return e.Y().toString().slice(-2)},a:function(){return g.am_pm[h.getHours()>11?1:0]},A:function(){return e.a().toUpperCase()},B:function(){var l=h.getUTCHours()*3600;var f=h.getUTCMinutes()*60;var m=h.getUTCSeconds();return c(Math.floor((l+f+m+3600)/86.4)%1000,3)},g:function(){return e.G()%12||12},G:function(){return h.getHours()},h:function(){return c(e.g(),2)},H:function(){return c(e.G(),2)},i:function(){return c(h.getMinutes(),2)},s:function(){return c(h.getSeconds(),2)},u:function(){return c(h.getMilliseconds()*1000,6)},e:function(){return"UTC"},I:function(){var l=new Date(e.Y(),0);var n=Date.UTC(e.Y(),0);var f=new Date(e.Y(),6);var m=Date.UTC(e.Y(),6);return((l-n)!==(f-m))?1:0},O:function(){var l=h.getTimezoneOffset();var f=Math.abs(l);return(l>0?"-":"+")+c(Math.floor(f/60)*100+f%60,4)},P:function(){var f=e.O();return f.substr(0,3)+":"+f.substr(3,2)},T:function(){return"UTC"},Z:function(){return -h.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(b,a)},r:function(){return"D, d M Y H:i:s O".replace(b,a)},U:function(){return Math.floor(h/1000)},C:function(){h.setMinutes(h.getMinutes()+h.getTimezoneOffset());return"Y-m-d\\TH:i:s\\Z".replace(b,a)},"$":function(){return h.toLocaleString()}};k=function(l,f){h=(f===undefined?new Date():(f instanceof Date)?new Date(f):new Date(f*1000));return l.replace(b,a)};return k(j,d)}function parse_dt(g,h,e){var a=new Date(0),b;var d=/\\?(.?)/gi;var c=function(f,j){if(b[f]){b[f]()}else{if(j){var k=b.readNchars(j.length);if(k!=j){throw'"'+j+'" expected instead of "'+k+'" in parse_dt.'}}}};b={in_str:g,peekNchars:function(f){return this.in_str.substr(0,f)},readNchars:function(j){var f=this.peekNchars(j);this.in_str=this.in_str.substr(j);return f},countDigits:function(j){var f=0;while(f<this.in_str.length&&f<j&&this.in_str.substr(f,1).match(/\d/)){f++}return f},readMaxNdigits:function(j){var f=this.countDigits(j);if(f>0){return Number(this.readNchars(f))}throw j+' digits expected instead of "'+this.in_str+'" in parse_dt.'},readNdigits:function(j){var f=this.countDigits(j);if(f==j){return Number(this.readNchars(f))}throw"Exactly "+j+' digits expected instead of "'+this.in_str+'" in parse_dt.'},readWord:function(j){var f=this.peekNchars(j.length);if(f.toLowerCase()==j.toLowerCase()){return this.readNchars(j.length)}return null},readFirstWord:function(k){var j=0,f=k.length;for(;j<f;j++){if(this.readWord(k[j])){return j}}return null},d:function(){a.setDate(this.readNdigits(2))},j:function(){a.setDate(this.readMaxNdigits(2))},S:function(){var f=b.j();var k=f%10;if(k<=3&&parseInt((f%100)/10,10)==1){k=0}return["st","nd","rd"][k-1]||"th"},z:function(){a.setDate(this.readMaxNdigits(3)+1)},F:function(){var f=this.readFirstWord(h.MONTH_LONG_NAMES);if(f==null){throw'Month name expected instead of "'+this.in_str+'".'}a.setMonth(f)},m:function(){a.setMonth(this.readNdigits(2)-1)},M:function(){var f=this.readFirstWord(h.MONTH_SHORT_NAMES);if(f==null){throw'Month abbreviation expected instead of "'+this.in_str+'".'}a.setMonth(f)},n:function(){a.setMonth(this.readMaxNdigits(2)-1)},Y:function(){a.setFullYear(this.readNdigits(4))},y:function(){var f=this.readNdigits(2);a.setFullYear((f>49?1900:2000)+f)},a:function(){if(this.readWord(h.am_pm[0])){return}else{if(this.readWord(h.am_pm[1])){a.setHours(a.getHours()+12)}else{throw am_pm[0]+"/"+am_pm[1]+' expected instead of "'+this.in_str+'".'}}},A:function(){b.a()},g:function(){a.setHours(this.readMaxNdigits(2))},G:function(){a.setHours(this.readMaxNdigits(2))},h:function(){a.setHours(this.readNdigits(2))},H:function(){a.setHours(this.readNdigits(2))},i:function(){a.setMinutes(this.readNdigits(2))},s:function(){a.setSeconds(this.readNdigits(2))},u:function(){a.setMilliseconds(this.readMaxNdigits(6)/1000)},O:function(){var j=this.readFirstWord(["+","-"]);if(j==null){throw'+/- sign expected instead of "'+this.in_str+'".'}var k=this.readNdigits(2);var f=this.readNdigits(2);a.setMinutes(a.getMinutes()-(j?-1:1)*(60*k+f)-a.getTimezoneOffset())},P:function(){var j=this.readFirstWord(["+","-"]);if(j==null){throw'+/- sign expected instead of "'+this.in_str+'".'}var k=this.readNdigits(2);var l=this.readFirstWord([":"]);if(l==null){throw'":" expected instead of "'+this.in_str+'".'}var f=this.readNdigits(2);a.setMinutes(a.getMinutes()-(j?-1:1)*(60*k+f)-a.getTimezoneOffset())},c:function(){return"Y-m-d\\TH:i:sP".replace(d,c)},r:function(){return"D, d M Y H:i:s O".replace(d,c)},U:function(){a.setMilliseconds(this.readMaxNdigits(99)*1000)},C:function(){a=new Date(this.in_str)},"$":function(){a=new Date(this.in_str)}};e.replace(d,c);return a}function GetParentControl(b){var a=$("#"+b).parents(".tab-pane,[ctrl_type]").first();if(a.hasClass("tab-pane")){return a.attr("id").replace(/^ui-id-/,"")}else{return a.attr("id")}}function GetChildControl(a,b){var c=$("#"+b).find("[layout_record_field_name="+JSON.stringify(a)+"]");if(!c.length){c=$("#"+b+" #"+a)}return c.attr("id")}function GetIndexedControl(a,b){var c=$("#"+b).children("[_sys_listindex="+JSON.stringify(a)+"]");return c.attr("id")}function GetCurrentRecord(a){var b=$(a).closest('[ctrl_type="layout_record"]');return b.attr("id")}function SetFocusAndShow(c){if(!c){return}var d=$("#"+c);var a=$("#thePage");if(!(a.scrollTop()==0&&d.offset().top>0&&d.offset().top<a.height())){var b=a.scrollTop()+d.offset().top;if(a.css("padding-top")){b-=Number(a.css("padding-top").replace("px",""))}a.animate({scrollTop:b},250)}d.focus()}var cListItemPrefix="_sys_list_item_";var g_nextListItemIndex=1;var cInListClass="_sys_in_list";var cAfterAppendRecordEventPrefix="_sys_after_append_record_";var cAfterRecordSelectedPrefix="_sys_after_record_selected_";var cAdvgridClassPrefix="_sys_advgrid_class_";var cAdvsectionClassPrefix="_sys_advsection_class_";var cInvalidationMessagePrefix="_sys_invalidation-message-";var g_webStorage=[];function ControlIsHidden(a){if(!a.length){return false}if(a[0]==a.context){return false}if(a.hasClass("panel-collapse")){if(a.hasClass("hidden")){return true}}else{if(a.is("[ctrl_type]")&&a.css("display")=="none"){return true}}if(a.hasClass("tab-pane")){var b=a.attr("id").replace(/^ui-id-/,"");if(!GetControlProp(b,"visible")||!GetControlProp(b,"enabled")){return true}}return ControlIsHidden(a.parent())}function SetInvalidationMessage2(e,b,f){var c=$("#"+e);var d=Control_type_of_$(c);var a=c.attr("data-isvalid")==="false";b=b||a?true:false;if(ControlTypeHasProp(d,"readonly")&&GetControlProp(e,"readonly")){return}if(ControlTypeHasProp(d,"enabled")&&!GetControlProp(e,"enabled")){return}if(ControlIsHidden(c)){return}c.toggleClass("invalid_input",b);c.closest("div.bootstrap-select").toggleClass("invalid_input",b);if(b&&f){$("#"+AddPrefix(cInvalidationMessagePrefix,e)).text(f)}else{$("#"+AddPrefix(cInvalidationMessagePrefix,e)).empty()}}function FirstInvalidControl(){var a=AllInvalidControls();return a.length?a[0]:""}function AllInvalidControls(){var a=[];$('[id^="'+cInvalidationMessagePrefix+'"]').each(function(){var d=DelPrefix(cInvalidationMessagePrefix,this.id);var b=$("#"+d);var c=Control_type_of_$(b);if(b.parents("._sys_list_template").length){return}if(ControlTypeHasProp(c,"readonly")&&GetControlProp(d,"readonly")){return}if(ControlTypeHasProp(c,"enabled")&&!GetControlProp(d,"enabled")){return}if(ControlIsHidden(b)){return}b.trigger("control_validating");if(b.hasClass("invalid_input")){a.push(d)}});return a}function DoGetReport(d,c,b){c._sys_report_id=d;c._sys_report_format=b=="_sys_newtabPDF"?"PDF":"HTML";if(b=="_sys_newtabPDF"){var e="";for(var a in c){if(e!=""){e+="&"}e+=a+"="+encodeURIComponent(c[a])}window.open("get_report.php?"+e)}else{SecureAJAX("get_report.php",{data:c,success:function(f){if(b=="_sys_newtabHTML"){window.open().document.write(f)}else{SetControlProp(b,"content",f)}}})}}var loadedHelpDocs={};function DoGetHelp(c,b){if(loadedHelpDocs[c]){return loadedHelpDocs[c]}else{b._sys_report_id=c;var a;SecureAJAX("get_report.php",{data:b,async:false,success:function(e){a=e}});loadedHelpDocs[c]=a;return a}}function GetCurrentFrameID(a){return(a=="X"&&window.frameElement)?window.frameElement.name:a}function DoGetPage(d,a,b,c){a=GetCurrentFrameID(a);if(g_TopFrame&&g_TopFrame.DoGetPage){g_TopFrame.DoGetPage(d,a,b,c)}}function SetWindowTitle(c){var b=$("body").css("background-color").replace(/[rgb() ]/g,"").split(",").map(parseFloat);var a=0.3*b[0]+0.6*b[1]+0.1*b[2]<128;if(window.top.SetWindowTitle&&GetCurrentFrameID("X")==="M"){window.top.SetWindowTitle(c,a)}}function ProcessPageParams(){var g={};function h(n,v,r){var s,q,m=r,t,l=/\[([^\]]*)\]/g,u=[n.replace(l,"")];while(t=l.exec(n)){u.push(t[1])}while(true){q=u.shift();if(q.trim()==""){if(m.constructor.name=="Array"){q=m.length}else{if(m===r){q=null}else{q=-1;for(s in m){if(+s>q){q=+s}}q++}}}if(u.length){if(m[q]==null||typeof m[q]!="object"){m[q]=isNaN(u[0])?({}):[]}m=m[q]}else{m[q]=v===""?null:v;break}}return r}var e,d,a,j,f=[],c=(window.location.search.substring(1)).split("&"),b=c.length;for(e=0;e<b;e++){if(c[e]===""){continue}a=c[e].split("=");d=decodeURIComponent(a[0]);j=a[1];j=(j!=null)?decodeURIComponent(j.replace(/\+/g,"%20")):"";f.push([d,j])}for(e=0,b=f.length;e<b;e++){h(f[e][0],f[e][1],g)}document.pageParams=g}function Get_sys_FrameNonce(){if(window.name){return window.name}if(window.parent&&window.parent!=window&&window.parent.Get_sys_FrameNonce){return window.parent.Get_sys_FrameNonce()}return null}function GetSessionValue(a){if(g_TopFrame&&g_TopFrame.GetSessionValue){return g_TopFrame.GetSessionValue(a)}return null}function SetSessionValue(a,b){if(g_TopFrame&&g_TopFrame.SetSessionValue){g_TopFrame.SetSessionValue(a,b)}}function IncludeSessionValue(a,b){if(g_TopFrame&&g_TopFrame.IncludeSessionValue){g_TopFrame.IncludeSessionValue(a,b)}}function GetUserInfo(){if(g_TopFrame&&g_TopFrame.GetUserInfo){return g_TopFrame.GetUserInfo()}return null}function GetServerDatetime(){if(g_TopFrame&&g_TopFrame.GetServerDatetime){return new Date(g_TopFrame.GetServerDatetime())}return null}function RenderDatatableCell(a,c,b,d){if(g_TopFrame&&g_TopFrame.RenderDatatableCell){return g_TopFrame.RenderDatatableCell(a,c,b,d)}return null}function RelURLFromSNAP(a){if(a.indexOf("://")<0){a="../"+a}return a}function WindowOpen(a){if(a){window.open(a)}}function PostToUrl(a,c,b){var d="_sys_post_form";$("<form>").attr("method","POST").attr("action",a).attr("target",b).attr("id",d).hide().appendTo("body");$.each(c||{},function(f,e){$("<input>").attr("name",e).attr("value",f).appendTo("#"+d)});$("#"+d).submit().remove()}function DoGetURL(b,c,a){if(!b){return}b=RelURLFromSNAP(b);var d=$.param(c).replace(/\+/g,"%20");b=b+(d?"?"+d:"");switch(a){case"here":window.location=b;break;case"herw":g_TopFrame.location=b;break;case"neww":window.open(b);break;default:SnapSysError('Unimplemented "open URL" target window: '+a)}}function DoUpdateValue(){}function GetTextFieldValue(a){var b=$("#"+a);if(b.hasClass("upcase_field")){return b.val().toUpperCase()}if(b.hasClass("locase_field")){return b.val().toLowerCase()}return b.val()}function SetTextFieldValue(b,a){SetTextFieldValue2($("#"+b),a)}function SetTextFieldValue2(b,a){if(b.hasClass("upcase_field")&&a&&a.toUpperCase){a=a.toUpperCase()}else{if(b.hasClass("locase_field")&&a&&a.toLowerCase){a=a.toLowerCase()}}b.val(a).trigger("control_valuechanged")}function SayToFrame(e,a,d){var b;if(e){if(e==="."){b=window}else{var c=window.document.getElementById(e);if(c){b=c.contentWindow}else{RunTimeError("SayToFrame: iFrame "+JSON.stringify(e)+" is not loaded.")}}}else{b=window.parent}if(b.$){b.$(b.document.body).trigger("say_"+a,[d,window.frameElement.id||window.frameElement.name])}else{RunTimeError("SayToFrame: iFrame "+JSON.stringify(e)+" has no $.")}}function SetFrameUniv(b,a){if($("#"+b).hasClass("autoframe")){RunTimeError(b+" frame is not fix sized.")}else{$("#"+b).prop("height",a)}}function GetFrameUniv(a){return[window.document.getElementById(a).clientHeight,window.document.getElementById(a).clientWidth]}function SetFrameLoaded(c,a,b){if(g_TopFrame&&g_TopFrame.SetFrameLoaded){g_TopFrame.SetFrameLoaded(c,a,b)}}function GetIFrameLoaded(a){if(g_TopFrame&&g_TopFrame.GetIFrameLoaded){return g_TopFrame.GetIFrameLoaded(a)}return null}function DoSetFrame(e,d,b,a,c){if(g_TopFrame&&g_TopFrame.DoSetFrame){g_TopFrame.DoSetFrame(e,window.document.getElementById(d),b,a,c)}}function GetPanelUniv(a,b){a=GetCurrentFrameID(a);if(g_TopFrame&&g_TopFrame.GetPanelUniv){return g_TopFrame.GetPanelUniv(a,b)}return null}function SetPanelUniv(a,b){if(g_TopFrame&&g_TopFrame.SetPanelUniv){g_TopFrame.SetPanelUniv(a,b)}}function GetPanelLoaded(a){a=GetCurrentFrameID(a);if(g_TopFrame&&g_TopFrame.GetPanelLoaded){return g_TopFrame.GetPanelLoaded(a)}return null}function SetPanelLoaded(c,e,b,a,d){if(g_TopFrame&&g_TopFrame.SetPanelLoaded){g_TopFrame.SetPanelLoaded(c,e,b,a,d)}}function SayToPanel(b,a,c){b=GetCurrentFrameID(b);if(g_TopFrame&&g_TopFrame.SayToPanel){g_TopFrame.SayToPanel(b,a,c,window.frameElement.id||window.frameElement.name)}}function OpenPageDialog(d,a,c,b){if(g_TopFrame&&g_TopFrame.OpenPageDialog){g_TopFrame.OpenPageDialog(d,a,c,b)}}function ClosePageDialog(b,a){if(g_TopFrame&&g_TopFrame.ClosePageDialog){g_TopFrame.ClosePageDialog(b,a)}}function RevealAdvPanel(){if(g_TopFrame&&g_TopFrame.RevealAdvPanel){g_TopFrame.RevealAdvPanel()}}function RevealNavPanel(){if(g_TopFrame&&g_TopFrame.RevealNavPanel){g_TopFrame.RevealNavPanel()}}function RecalcControls(c,a){if(a){return}var b=c.find(".dataTable,.bxslider,.timeline,canvas").not(".hidden").add(c);b.filter(".dataTable:visible").not(".snap-recalc-ok").each(function(){$(this).DataTable().draw().responsive.recalc()}).trigger("resize").addClass("snap-recalc-ok",true);b.filter(".bxslider").each(function(){var d=$(this).data("carouselObject");if(d){var e=d.getCurrentSlide();d.reloadSlider();d.goToSlide(e)}});b.filter(".timeline").each(function(){var d=$(this).data("timelineObject");if(d){d.redraw()}});b.filter("canvas").each(function(){$(this).data("chartObject").resize()});c.find('[ctrl_type="ctr-calendar"]').each(function(d,f){$(f).fullCalendar("render")})}function GetArrayElement(b,a){return(b&&a<b.length)?b[a]:undefined}function ValueToLocaleString(a){return a.toLocaleString()}function ValueToString(a){return a.toString()}function SetNumbersToLocale(d,b){var c,a=d.length;for(c=0;c<a;c++){if(d[c].ticks){d[c].ticks.callback=b?ValueToLocaleString:ValueToString}}}function GetChartProperty(b,a){var c=$("#"+b);return c.data(a)}var cChartTypes={Bar:"bar",Doughnut:"doughnut",hBar:"horizontalBar",Line:"line",Pie:"pie"};var cSegmentColorDefaults=["#A6CEE3","#1F78B4","#B2DF8A","#33A02C","#FB9A99","#E31A1C","#FDBF6F","#FF7F00","#CAB2D6","#6A3D9A","#B4B482","#B15928"];var cSegmentHighlightColorDefaults=["#CEF6FF","#47A0DC","#DAFFB2","#5BC854","#FFC2C1","#FF4244","#FFE797","#FFA728","#F2DAFE","#9265C2","#DCDCAA","#D98150"];function SetChartProperty(a,h,v,l){var o=$("#"+a);if(h){o.data(h,v)}if(!l){return}if(o.data("chartObject")){o.data("chartObject").destroy()}try{var j=o.data("chartType");var y=o.data("chartValues");var m=o.data("chartLabels");var x=o.data("chartBarLabels");var C=o.data("chartFillColors")||cSegmentColorDefaults;var c=o.data("chartStrokeColors")||cSegmentColorDefaults;var r=o.data("chartHFillColors")||cSegmentHighlightColorDefaults;var f=o.data("chartHStrokeColors")||cSegmentHighlightColorDefaults;var q=o.data("chartPFillColors")||cSegmentColorDefaults;var b=o.data("chartPStrokeColors")||cSegmentColorDefaults;var u=o.data("chartSteppedLine");var B=o.data("chartHitRadius");var n=o.data("chartHoverRadius");var k=o.data("chartHBorderWidth");var A,t=0,w=y?y.length:0;switch(j){case"Bar":case"hBar":A={};A.labels=m?JSON.parse(JSON.stringify(m)):[];A.datasets=[];for(;t<w;t++){A.datasets.push({label:GetArrayElement(x,t),backgroundColor:GetArrayElement(C,t),borderColor:GetArrayElement(c,t),hoverBackgroundColor:GetArrayElement(r,t),hoverBorderColor:GetArrayElement(f,t),hoverBorderWidth:GetArrayElement(k,t),data:GetArrayElement(y,t)})}break;case"Line":A={};A.labels=m?JSON.parse(JSON.stringify(m)):[];A.datasets=[];for(;t<w;t++){A.datasets.push({label:GetArrayElement(x,t),backgroundColor:GetArrayElement(C,t),borderColor:GetArrayElement(c,t),pointHoverBackgroundColor:GetArrayElement(r,t),pointHoverBorderColor:GetArrayElement(f,t),pointBackgroundColor:GetArrayElement(q,t),pointBorderColor:GetArrayElement(b,t),steppedLine:GetArrayElement(u,t),hitRadius:GetArrayElement(B,t),pointHoverRadius:GetArrayElement(n,t),pointHoverBorderWidth:GetArrayElement(k,t),data:GetArrayElement(y,t)})}break;case"Doughnut":case"Pie":A={};A.labels=m?JSON.parse(JSON.stringify(m)):[];A.datasets=[];for(;t<w;t++){A.datasets.push({label:GetArrayElement(x,t),backgroundColor:C,borderColor:c,hoverBackgroundColor:r,hoverBorderColor:f,hoverBorderWidth:GetArrayElement(k,t),data:GetArrayElement(y,t)})}break}var s=o.data("chartOptions")||{};var g=o.data("numbersToLocale")||false;if(s&&s.scales&&s.scales.xAxes){SetNumbersToLocale(s.scales.xAxes,g)}if(s&&s.scales&&s.scales.yAxes){SetNumbersToLocale(s.scales.yAxes,g)}o.data("chartObject",new Chart(o,{type:cChartTypes[j],data:A,options:s}))}catch(z){SnapSysError('SetChartProperty: Error in setting the "'+h+'" chart property for #'+a+" ["+j+"]:",z)}}function GetChartClickedData(a){return $(a.target).data("chartObject").getElementAtEvent(a)}function ProcessCalEvent(a,c){var b;if(c){b={start:a.start!=null?a.start.toDate().toISOString().split(".")[0]+"Z":"",end:a.end!=null?a.end.toDate().toISOString().split(".")[0]+"Z":""}}else{b={start:a.start!=null?a.start.toDate():null,end:a.end!=null?a.end.toDate():null}}delete a.source;delete a.className;delete a.start;delete a.end;$.extend(b,a);return b}function ProcessCalEvents(a,c){var b=[];$.each(a,function(d,f){b.push(ProcessCalEvent(f,c))});return b}function Control_type_of_$(b){var a="";if(b.length>0){a=b.attr("ctrl_type")}return a}function Control_type(a){if(!a||a=="?"||!$){return""}if(a.indexOf(".")>-1){return"datatable_header"}return Control_type_of_$($("#"+a))}var cTextInputProperties=[["aria label","aria-label",["String"]],["context","context",["String"]],["enabled","enabled",["Boolean"]],["help text","help",["String"]],["label","label",["String"]],["mask","mask",["jsObject","String"]],["placeholder","placeholder",["String"]],["read only","readonly",["Boolean"]],["suggestions","suggestions",["Array"]],["tooltip-title","tooltip",["String"]],["value","value",["String","Number","Boolean","jsColour"]]];var cButtonProperties=[["aria label","aria-label",["String"]],["context","context",["String"]],["caption","text",["String","Number","Boolean"]],["enabled","enabled",["Boolean"]],["icon","icon",["String"]],["tooltip-title","tooltip",["String"]]];var cControlProperties={advgrid:[],advsection:[["enabled","enabled",["Boolean"]],["hollowed","hollowed",["Boolean"]],["read only","readonly",["Boolean"]]],button:cButtonProperties,dropdown_button:cButtonProperties,"ctr-calendar":[["aria label","aria-label",["String"]],["businessHours","businessHours",["jsObject","Array"]],["currentDate","currentDate",["DateTime","String"]],["enabled","enabled",["Boolean"]],["hiddenDays","hiddenDays",["Array"]],["navLinks","navLinks",["Boolean"]],["validRange","validRange",["jsObject"]],["value","value",["Array"]],["weekNumbers","weekNumbers",["Boolean"]],["view","view",["String"]]],carousel:[["pager","pager",["Boolean"]],["slides","slides",["Array"]],["value","value",["Number"]]],chart:[["chart type","chartType",["String"]],["chart values","chartValues",["Array"]],["chart labels","chartLabels",["Array"]],["segment labels","chartBarLabels",["Array"]],["localize numbers","numbersToLocale",["Boolean"]],["chart options","chartOptions",["jsObject"]],["chart fill colors","chartFillColors",["Array"]],["chart border colors","chartStrokeColors",["Array"]],["hover fill colors","chartHFillColors",["Array"]],["hover border colors","chartHStrokeColors",["Array"]],["point fill colors","chartPFillColors",["Array"]],["point border colors","chartPStrokeColors",["Array"]],["label","label",["String"]],["stepped line","chartSteppedLine",["Array"]],["hit radius","chartHitRadius",["Array"]],["hover radius","chartHoverRadius",["Array"]],["hover border widths","chartHBorderWidth",["Array"]]],checkbox:[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["label","label",["String"]],["value","value",["Boolean"]],["help text","help",["String"]],["read only","readonly",["Boolean"]],["tooltip-title","tooltip",["String"]]],"checkbox-custom":[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["label","label",["String"]],["read only","readonly",["Boolean"]],["value","value",["String"]],["tooltip-title","tooltip",["String"]]],collapsible:[["caption","caption",["String","Number","Boolean"]],["collapsed","collapsed",["Boolean"]],["enabled","enabled",["Boolean"]]],"collapsible-set":[["enabled","enabled",["Boolean"]]],container:[["content","content",["String"]]],"controlgroup-radio":[["enabled","enabled",["Boolean"]],["label","label",["String"]],["value","value",["String"]]],dataholder:[["read only","readonly",["Boolean"]],["value","value",["String"]]],datatable:[["enabled","enabled",["Boolean"]],["order","order",["Array"]],["page","page",["Number"]],["selected rows","selected_rows",["Array"]],["tooltip-title","tooltip",["String"]],["value","value",["Array"]]],datatable_header:[["caption","caption",["String"]]],"datetime-input":[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["read only","readonly",["Boolean"]],["label","label",["String"]],["value","value",["DateTime"]],["minDate","minDate",["DateTime"]],["maxDate","maxDate",["DateTime"]],["enabledDates","enabledDates",["Array"]],["disabledDates","disabledDates",["Array"]],["enabledHours","enabledHours",["Array"]],["disabledHours","disabledHours",["Array"]],["placeholder","placeholder",["String"]],["tooltip-title","tooltip",["String"]],["help text","help",["String"]]],expandable:[["enabled","enabled",["Boolean"]],["expanded","expanded",["Boolean"]]],flipswitch:[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["label","label",["String"]],["read only","readonly",["Boolean"]],["value","value",["Boolean"]],["tooltip-title","tooltip",["String"]]],"flipswitch-custom":[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["label","label",["String"]],["read only","readonly",["Boolean"]],["value","value",["String"]],["tooltip-title","tooltip",["String"]]],footer:[],fragment:[["content","content",["String"]]],google_map:[["locations","locations",["String","Array","jsObject"]],["zoom","zoom",["Number"]],["height","height",["Number"]],["mapType","mapType",["String"]]],google_map_streetview:[["locations","locations",["String","Array","jsObject"]],["zoom","zoom",["Number"]],["height","height",["Number"]],["mapType","mapType",["String"]]],grid:[],grid12:[],header:[],icon:[["aria label","aria-label",["String"]],["context","context",["String"]],["icon","icon",["String"]],["tooltip-title","tooltip",["String"]]],"fa-icon":[["aria label","aria-label",["String"]],["context","context",["String"]],["icon","icon",["String"]]],iframe:[],image:[["aria label","aria-label",["String"]],["image","image",["String"]],["tooltip-title","tooltip",["String"]]],"input-color":cTextInputProperties,"input-date":cTextInputProperties,"input-datetime":cTextInputProperties,"input-datetime-local":cTextInputProperties,"input-email":cTextInputProperties,"input-file":[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["files","files",["Array"]],["label","label",["String"]],["tooltip-title","tooltip",["String"]]],"input-hidden":[["value","value",["String","Number","Boolean"]]],"input-month":cTextInputProperties,"input-number":cTextInputProperties,"input-password":cTextInputProperties,"input-search":cTextInputProperties,"input-tel":cTextInputProperties,"input-text":cTextInputProperties,"input-time":cTextInputProperties,"input-url":cTextInputProperties,"input-week":cTextInputProperties,layout_list:[["all selected records by ID","asr_id",["Array"]],["all selected records by index","asr_index",["Array"]],["first selected record by ID","fsr_id",["String"]],["first selected record by index","fsr_index",["Number"]],["all visible records by ID","avr_id",["Array"]],["all visible records by index","avr_index",["Array"]],["read only","readonly",["Boolean"]],["page","page",["Number"]],["value","value",["Array"]]],layout_record:[["list index","listindex",["Number"]],["read only","readonly",["Boolean"]],["value","value",["jsObject"]]],link:[],listitem:[["header","header",["String"]],["caption","caption",["String"]],["aside","aside",["String"]],["tooltip","tooltip",["String"]],["aria label","aria-label",["String"]]],listview:[["list items","list_items",["Array"]]],main:[["title","title",["String"]]],navbar:[["aria label","aria-label",["String"]]],"otp-icon":[["aria label","aria-label",["String"]],["icon","icon",["String"]],["tooltip-title","tooltip",["String"]]],page:[],panel:[["context","context",["String"]],["enabled","enabled",["Boolean"]],["header","header",["String","Number","Boolean"]],["footer","footer",["String","Number","Boolean"]]],popup:[],progress:[["value","value",["Number"]],["max","max",["Number"]],["tooltip-title","tooltip",["String"]]],radiobutton:[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["label","label",["String"]],["read only","readonly",["Boolean"]],["value","value",["Boolean"]],["tooltip-title","tooltip",["String"]]],"range-input":[["aria label","aria-label",["String"]],["enabled","enabled",["Boolean"]],["label","label",["String"]],["max","max",["Number"]],["min","min",["Number"]],["step","step",["Number"]],["value","value",["Number"]],["tooltip-title","tooltip",["String"]]],"rich-text":[["aria label","aria-label",["String"]],["read only","readonly",["Boolean"]],["value","value",["String"]]],section:[],selectmenu:[["aria label","aria-label",["String"]],["display","display",["String","Array"]],["enabled","enabled",["Boolean"]],["label","label",["String"]],["options","options",["Array"]],["placeholder","placeholder",["String"]],["search","search",["String"]],["read only","readonly",["Boolean"]],["value","value",["String","Array"]],["tooltip-title","tooltip",["String"]],["help text","help",["String"]]],splitter:[],tabbar:[],tabitem:[["active","active",["Boolean"]],["caption","caption",["String"]],["enabled","enabled",["Boolean"]]],"tag-hr":[],"telekom-icon":[["aria label","aria-label",["String"]],["context","context",["String"]],["icon","icon",["String"]],["tooltip-title","tooltip",["String"]]],text:[["caption","text",["String","Number","Boolean"]],["clickable","clickable",["Boolean"]],["context","context",["String"]],["label","label",["String"]],["tooltip-title","tooltip",["String"]]],"textarea-input":cTextInputProperties,timeline:[["selection","selection",["Array"]],["center","center",["String","DateTime"]],["range","range",["jsObject"]],["items","items",["Array"]],["groups","groups",["Array"]],["options","options",["jsObject"]]],"Youtube-Embed":[]};var cButtonContextClasses=["btn-default","btn-primary","btn-success","btn-info","btn-warning","btn-danger","btn-link"];var cInputContainerContextClasses=["has-success","has-warning","has-error"];var cPanelContextClasses=["panel-primary","panel-success","panel-info","panel-warning","panel-danger"];var cTextContextClasses=["text-primary","text-success","text-info","text-warning","text-danger","text-muted"];var cListItemContextClasses=["list-group-item-success","list-group-item-secondary","list-group-item-info","list-group-item-warning","list-group-item-danger","list-group-item-primary","list-group-item-dark","list-group-item-light"];var cDisablableControlsSelector='.mdl-slider,button,input,select,table,textarea,[ctrl_type="ctr-calendar"]';var cReadOnlyControlsSelector='input:not([type=range]):not(.ll-filter),textarea,[ctrl_type="rich-text"],[ctrl_type="selectmenu"]';var cLocalizableProperties=["caption","label","help","tooltip","placeholder","header","footer","text","aria-label","title"];function GetControlValue(b,a){return GetControlProp(b,a)}function GetControlProp(k,o){var q=undefined;if(!k){return q}if(k=="?"){return q}var m,f,d=Control_type(k);var g="";if(k.indexOf(".")>-1){g="#"+k.substring(0,k.indexOf("."));k=k.split(".").pop();m=$(g+" th#"+k)}else{m=$("#"+k)}if(m.length==0&&g==""){RunTimeError("GetControlProp: #"+k+" does not exist.");return""}switch(o){case"aria-label":return m.attr(o);case"mask":return m.inputmask("getmetadata");case"visible":switch(d){case"listitem":if(m.is("li")){return !m.hasClass("hidden")}else{return !m.parent().hasClass("hidden")}case"carousel":case"range-input":case"selectmenu":case"datetime-input":return !m.closest("div.visible-wrapper").hasClass("hidden");case"datatable_header":return !!m.length&&!m.hasClass("hidden")&&$(g).DataTable().column("#"+k).visible();case"collapsible":return !m.closest(".panel").hasClass("hidden");default:return !m.hasClass("hidden")}case"tooltip":switch(d){case"flipswitch":return $('span[data-for="'+k+'"]').attr("data-original-title");case"range-input":return m.closest("div.visible-wrapper").attr("data-original-title");case"listitem":return m.is("li")?m.attr("data-original-title"):m.closest("li").attr("data-original-title");default:return m.attr("data-original-title")}case"label":if(d=="controlgroup-radio"){return $('div[id="'+k+'"] legend').clone().children().remove().end().text()}else{if(d=="flipswitch"){return $('span[for="'+k+'"]').text()}else{return $('label[for="'+k+'"]').clone().children().remove().end().text()}}case"context":var n="default";if(d=="button"||d=="dropdown_button"){$.each(cButtonContextClasses,function(r,s){if(m.hasClass(s)){n=s.substr(4)}});return n}else{if(d=="panel"){$.each(cPanelContextClasses,function(r,s){if(m.hasClass(s)){n=s.substr(6)}});return n}else{if(d.substr(0,6)=="input-"||d=="textarea-input"){$.each(cInputContainerContextClasses,function(r,s){if(m.closest(".form-group").hasClass(s)){n=s.substr(4)}});return n}else{if(d=="text"||d=="icon"||d=="fa-icon"||d=="otp-icon"||d=="telekom-icon"){n="default";$.each(cTextContextClasses,function(r,s){if(m.hasClass(s)){n=s.substr(5)}});return n}}}}RunTimeError("GetControlProp: "+d+"."+o+" is not handled for #"+k);return n;case"suggestions":q=[];$('li[data-for="'+k+'"] h4').each(function(){q.push($(this).text())});return q}switch(d){case"button":case"dropdown_button":switch(o){case"caption":case"text":return m.clone().children().remove().end().text();case"enabled":return !m.attr("disabled");case"icon":if(m.find("i").hasClass("material-icons")){return m.find("i").text()}var j=m.find("i").attr("class")||"";var c=j.split(" ");for(f in c){if(c[f].substr(0,9)=="otp-snap-"){return c[f].substr(9)}}if(c[f].substr(0,7)=="t-icon-"){return c[f].substr(7)}return""}break;case"chart":if(cControlProperties.chart.some(function(r){return r[1]==o})){return GetChartProperty(k,o)}break;case"carousel":switch(o){case"pager":return m.hasClass("bxslider-pager");case"slides":q=[];m.find("li").not(".bx-clone").find("img").each(function(r,t){var s=t.src.indexOf("get_image.php?img=")>=0?t.src.match(/=([0-9]+)$/)[0].replace("=",""):t.src;q.push(s)});return q;case"value":return(m.data("carouselObject")).getCurrentSlide()+1}break;case"checkbox-custom":case"flipswitch-custom":switch(o){case"enabled":return !m.attr("disabled");case"readonly":return !!m.attr("disabled");case"value":if(m.prop("checked")){return m.attr("data-on-value")}else{return m.attr("data-off-value")}}break;case"container":switch(o){case"content":return m.attr("page_id")}break;case"checkbox":switch(o){case"enabled":return !m.attr("disabled");case"readonly":return !!m.attr("disabled");case"value":return m.prop("checked");case"help":return m.attr("data-help-text")}break;case"flipswitch":case"radiobutton":switch(o){case"enabled":return !m.attr("disabled");case"readonly":return !!m.attr("disabled");case"value":return m.prop("checked")}break;case"collapsible":switch(o){case"caption":return m.parent().find('a[href="#'+k+'"]').text();case"collapsed":return !m.hasClass("in");case"enabled":return $(m.data("parent")).find('a[href="#'+k+'"]').is("[data-toggle]")}break;case"main":switch(o){case"title":return m.attr("data-page_title")}break;case"advsection":case"collapsible-set":switch(o){case"enabled":return !m.hasClass("ui-state-disabled")&&!m.hasClass("snap-disabled");case"readonly":return m.hasClass("snap-readonly");case"hollowed":return !!m.data("stash")}break;case"expandable":switch(o){case"collapsed":case"expanded":return m.hasClass("open");case"enabled":return !m.hasClass("disabled")}break;case"controlgroup-radio":switch(o){case"enabled":return !m.hasClass("ui-state-disabled")&&!m.hasClass("snap-disabled");case"readonly":return m.hasClass("snap-readonly");case"value":q=null;m.find('input[type="radio"]').each(function(){if($(this).prop("checked")){q=this.value;return false}return true});return q}break;case"fragment":switch(o){case"content":return m.html()}break;case"icon":switch(o){case"icon":return m.text()}break;case"otp-icon":switch(o){case"icon":return m.attr("class").match(/ otp-[^ ]+/)[0].replace(/ (otp-|snap-)*/,"")}break;case"telekom-icon":switch(o){case"icon":return m.attr("class").match(/ t-icon-[^ ]+/)[0].replace(/ (t-icon-)*/,"")}break;case"fa-icon":switch(o){case"icon":return m.attr("class").match(/ fa-[^ ]+/)[0].replace(/ (fa-)*/,"")}break;case"input-file":switch(o){case"enabled":return !m.attr("disabled");case"files":q=[];var a=m.prop("files");for(f=0;f<a.length;f++){q.push({name:String(a[f].name),size:a[f].size,type:a[f].type,lastModified:a[f].lastModified,lastModifiedDate:a[f].lastModifiedDate})}return q}break;case"input-color":case"input-date":case"input-datetime":case"input-datetime-local":case"input-month":case"input-number":case"input-tel":case"input-time":case"input-search":case"input-url":case"input-week":switch(o){case"enabled":return !m.attr("disabled");case"placeholder":return m.attr("placeholder");case"readonly":return !!m.attr("readonly");case"value":return m.val();case"help":return m.attr("data-help-text")}break;case"datetime-input":switch(o){case"enabled":return !m.attr("disabled");case"readonly":return !!m.attr("readonly");case"value":var b=m.attr("data-io-format");if(b=="default"){return m.parent().data("DateTimePicker").date()!=null?m.parent().data("DateTimePicker").date().toDate():""}else{return m.parent().data("DateTimePicker").date()!=null?m.parent().data("DateTimePicker").date().format(b):""}case"minDate":return m.parent().data("DateTimePicker").minDate()?m.parent().data("DateTimePicker").minDate().toDate():null;case"maxDate":return m.parent().data("DateTimePicker").maxDate()?m.parent().data("DateTimePicker").maxDate().toDate():null;case"enabledDates":return m.parent().data("DateTimePicker").enabledDates();case"disabledDates":return m.parent().data("DateTimePicker").disabledDates();case"enabledHours":return m.parent().data("DateTimePicker").enabledHours();case"disabledHours":return m.parent().data("DateTimePicker").disabledHours();case"placeholder":return m.attr("placeholder");case"help":return m.attr("data-help-text")}break;case"ctr-calendar":switch(o){case"enabled":return !m.hasClass("ui-state-disabled");case"value":return ProcessCalEvents(m.fullCalendar("clientEvents"),false);case"currentDate":return m.fullCalendar("getDate").toDate();case"hiddenDays":case"businessHours":case"weekNumbers":case"validRange":case"navLinks":return m.fullCalendar("option",o);case"view":return m.fullCalendar("getView").type}break;case"rich-text":switch(o){case"readonly":return m.hasClass("snap-readonly");case"value":return m.data("ckeditor").getData()}break;case"image":switch(o){case"image":return DelPrefix("get_image.php?img=",m.attr("src"))}break;case"layout_list":q=[];switch(o){case"asr_id":case"fsr_id":$("#"+k+" > .ll-row-selected").each(function(r,s){q.push(s.id)});return(o=="asr_id")?q:q[0];case"asr_index":case"fsr_index":$("#"+k+" > .ll-row-selected").each(function(r,s){q.push(Number($(s).attr("_sys_listindex")))});return(o=="asr_index")?q:q[0];case"avr_id":case"avr_index":m.children(".list-group-item:not(.hidden-pagination)").not(".hidden-filter").not("._sys_list_template").each(function(r,s){if(o==="avr_id"){q.push(s.id)}else{q.push(s.getAttribute("_sys_listindex"))}});return q;case"page":return Number(m.attr("data-current-page"))||1;case"readonly":return m.hasClass("snap-readonly");case"value":q=[];EnumerateSubs(m.children(),function(s,r){q.push(r)},Number(m.attr("data-count")));return q}break;case"layout_record":switch(o){case"listindex":return m.attr("_sys_listindex");case"readonly":return m.hasClass("snap-readonly");case"value":q={};EnumerateSubs($("#"+k+" *[ctrl_type]"),function(s,r){q[s]=r},-1);return q}break;case"panel":switch(o){case"enabled":return !m.hasClass("ui-state-disabled");case"header":return m.children(".panel-heading").find(".panel-title").text();case"footer":return m.children(".panel-footer").text()}break;case"range-input":switch(o){case"enabled":return !m.attr("disabled");case"max":case"min":case"step":return parseInt(m.attr(o));case"value":return parseInt(m.val())}break;case"selectmenu":switch(o){case"display":if(!m.attr("multiple")){return m.children("option[value="+JSON.stringify(m.val())+"]").text()||null}q=[];var e=m.val();for(f in e){q.push(m.children("option[value="+JSON.stringify(e[f])+"]").text())}return q;case"enabled":return !m.attr("disabled");case"readonly":return !!m.attr("disabled");case"options":return SelectMenuOptionsToArray(k);case"search":var h=m.filter("[data-livesearch]").closest(".bootstrap-select").find(".bs-searchbox>input:visible");return h.length>0?h.val():null;case"placeholder":return m.children('option[data-placeholder="true"]').text();case"help":return m.attr("data-help-text");case"value":return m.val()}break;case"datatable":switch(o){case"enabled":return !m.attr("disabled");case"order":return m.DataTable().order();case"page":return 1+m.DataTable().page();case"selected_rows":return m.DataTable().rows({selected:true}).data().toArray();case"value":return m.DataTable().data().toArray()}break;case"datatable_header":switch(o){case"value":case"caption":return m.text()}break;case"text":switch(o){case"caption":case"text":return m.text();case"clickable":return m.hasClass("snap_clickable_text")}break;case"dataholder":case"input-email":case"input-hidden":case"input-password":case"input-text":case"textarea-input":switch(o){case"enabled":return !m.attr("disabled");case"placeholder":return m.attr("placeholder");case"readonly":return !!m.attr("readonly");case"value":return GetTextFieldValue(k);case"help":return m.attr("data-help-text")}break;case"progress":if(!m.hasClass("progress")){return m.prop(o)}switch(o){case"value":return parseInt(m.children(".progress-bar").attr("aria-valuenow"));case"max":return parseInt(m.children(".progress-bar").attr("aria-valuemax"))}break;case"tabitem":switch(o){case"active":return m.hasClass("active")||m.hasClass("ui-tabs-active");case"caption":return m.children("a").text();case"enabled":return !m.hasClass("disabled")}break;case"timeline":switch(o){case"selection":return m.data("timelineObject").getSelection();case"center":var l=m.data("timelineObject").getWindow();return new Date(l.start.getTime()+(l.end-l.start)/2);case"range":return m.data("timelineObject").getWindow();case"items":return m.data("timelineItems");case"groups":return m.data("timelineGroups");case"options":return m.data("timelineOptions")}break;case"google_map":switch(o){case"locations":if(m[0].gMap){if(m[0].gMap.markerParameters){let currentMarkers=[];let pin;for(let f=0;f<m[0].gMap.markerParameters.length;f++){pin={address:m[0].gMap.markerParameters[f].address,latitude:m[0].gMap.markerParameters[f].latitude,longitude:m[0].gMap.markerParameters[f].longitude,infowindow:m[0].gMap.markerParameters[f].infowindow,markertype:m[0].gMap.markerParameters[f].markertype};currentMarkers[m[0].gMap.markerParameters[f].order]=pin}return currentMarkers}}return[];case"height":return(m[0].gMap)?parseInt(m[0].gMap.getDiv().offsetHeight):0;case"zoom":return(m[0].gMap)?parseInt(m[0].gMap.getZoom()):0;case"mapType":return(m[0].gMap)?m[0].gMap.mapTypeId:""}break;case"google_map_streetview":switch(o){case"locations":if(m[0].gMap){return{latitude:m[0].gMap.getPosition().lat(),longitude:m[0].gMap.getPosition().lng()}}return"";case"height":return(m[0].gMap)?parseInt(m[0].offsetHeight):0;case"zoom":return(m[0].gMap)?parseInt(m[0].gMap.getZoom()):0;case"mapType":return(m[0].gMap)?m[0].gMap.mapTypeId:""}break;case"listview":switch(o){case"list_items":return ListViewToArray(m)}break;case"listitem":switch(o){case"header":return m.children("h4").text()||"";case"caption":return m.children("p").text()||"";case"aside":if(m.is("li")){return m.children("span").text()}else{return m.prev("span").text()}}}RunTimeError("GetControlProp: "+d+"."+o+" is not handled for #"+k);return""}function EnumerateSubs(b,d,a){var f=1;while(b.length){if(a>=0&&f>a){return}var e=b[0];var g=e.getAttribute("ctrl_type");if(!e.classList.contains("_sys_list_template")){var c=ReplaceValueProp(g,"value");if(ControlTypeHasProp(g,c)){d(e.getAttribute("layout_record_field_name")||e.getAttribute("id"),GetControlProp(e.id,c));f++}if(g=="layout_list"||g=="layout_record"){b=b.not("#"+e.id+" *[ctrl_type]")}}b=b.not(e)}}function ReplaceValueProp(a,b){switch(a){case"image":return"image";case"button":case"dropdown_button":case"text":return"text";case"collapsible":case"tabitem":return"caption";case"fragment":return"content";case"icon":case"fa-icon":return"icon";default:return b}}function OptionsHasProperty(d,c){var b=0,a=d.length;for(;b<a;b++){if(d[b][1]==c){return true}}return false}function ControlTypeHasProp(a,b){return cControlProperties[a]&&OptionsHasProperty(cControlProperties[a],b)}function SetControlValue(c,b,a){SetControlProp(c,b,a)}function SetControlProp(m,M,E){if(!m){return}if(m=="?"){return}var o;var W="";if(m.indexOf(".")>-1){W="#"+m.substring(0,m.indexOf("."));m=m.split(".").pop();o="datatable_header"}var R=$("#"+m);var V;var D;var ab;o=o||R.attr("ctrl_type");if(R.length==0&&W==""){RunTimeError("SetControlProp: #"+m+" does not exist.");return}switch(M){case"aria-label":return R.attr(M,E);case"mask":R.removeAttr("data-inputmask");if(E=="remove"){window.setTimeout(function(){R.inputmask(E)},0)}R.inputmask(E);return;case"visible":switch(o){case"range-input":case"selectmenu":R.closest("div.visible-wrapper").toggleClass("hidden",!E);return;case"carousel":R.closest("div.visible-wrapper").toggleClass("hidden",!E);RecalcControls(R,!E);return;case"datatable":R.parents("div.dataTables_wrapper").first().toggleClass("hidden",!E);R.toggleClass("hidden",!E);RecalcControls(R,!E);return;case"datatable_header":var T=W?$(W):R.parents("table").first();R.removeClass("hidden");$(T.DataTable().column("#"+m).nodes()).removeClass("hidden");T.DataTable().column("#"+m).visible(E,false);RecalcControls(R,false);return;case"listitem":if(R.is("li")){R.toggleClass("hidden",!E)}else{R.parent().toggleClass("hidden",!E)}return;case"listview":case"tabbar":if(R.next().hasClass("tab-content")){R.next().toggleClass("hidden",!E)}R.toggleClass("hidden",!E);RecalcControls(R,!E);return;case"tabitem":if(!E&&(R.hasClass("active")||R.hasClass("ui-state-active"))){var ae=R.prevAll().not(".hidden").last();if(!ae.length){ae=R.nextAll().not(".hidden").first()}if(ae.length){SetControlProp(ae.attr("id"),"active",true)}}R.toggleClass("hidden",!E);$("#ui-id-"+m).toggleClass("hidden",!E);if(E&&R.parent().children().not(".hidden").length==1){SetControlProp(m,"active",true)}return;case"radiobutton":R.parent(".radio").toggleClass("hidden",!E);case"button":case"dropdown_button":$('label[for="'+m+'"], #'+m).toggleClass("hidden",!E);return;default:$('label[for="'+m+'"], #'+m).toggleClass("hidden",!E);R.closest("div.visible-wrapper").toggleClass("hidden",!E);$("#"+cInvalidationMessagePrefix+m).toggleClass("hidden",!E);if(o=="collapsible"){R.closest(".panel").toggleClass("hidden",!E)}RecalcControls(R,!E);return}case"tooltip":switch(o){case"flipswitch":$('span[data-for="'+m+'"]').tooltip("hide").attr("data-original-title",E);return;case"checkbox":case"radiobutton":$('label[for="'+m+'"], #'+m).tooltip("hide").attr("data-original-title",E);return;case"range-input":R.closest("div.visible-wrapper").tooltip("hide").attr("data-original-title",E);return;case"selectmenu":R.tooltip("hide").attr("data-original-title",E);return;case"listitem":return R.is("li")?R.attr("data-original-title",E):R.closest("li").attr("data-original-title",E);default:R.tooltip("hide").attr("data-original-title",E);return}case"label":switch(o){case"controlgroup-radio":$('div[id="'+m+'"] legend').text(E);return;case"flipswitch":case"flipswitch-custom":$('span[for="'+m+'"]').text(E);return;default:var Y=$('label[for="'+m+'"]').first();var G=Y.children();Y.text(E).append(G);return}case"context":if(o=="button"||o=="dropdown_button"){R.removeClass(cButtonContextClasses.join(" "));if(cButtonContextClasses.indexOf("btn-"+E)!==-1){R.addClass("btn-"+E)}else{R.addClass("btn-default")}return}else{if(o=="panel"){R.removeClass(cPanelContextClasses.join(" "));if(cPanelContextClasses.indexOf("panel-"+E)!==-1){R.addClass("panel-"+E)}else{R.addClass("panel-default")}return}else{if(o.substr(0,6)=="input-"||o=="textarea-input"){R.closest(".form-group").removeClass(cInputContainerContextClasses.join(" "));if(cInputContainerContextClasses.indexOf("has-"+E)!==-1){R.closest(".form-group").addClass("has-"+E)}return}else{if(o=="text"||o=="icon"||o=="fa-icon"||o=="otp-icon"||o=="telekom-icon"){R.removeClass(cTextContextClasses.join(" "));if(E==="default"||E===null){return}if(cTextContextClasses.indexOf("text-"+E)!==-1){R.addClass("text-"+E);return}}}}}RunTimeError("SetControlProp: "+o+"."+M+" is not handled for #"+m);return;case"readonly":if(E&&R.hasClass("invalidation_message")){SetInvalidationMessage2(m,false,null)}break;case"value":if(R.hasClass("invalidation_message")){SetInvalidationMessage2(m,false,null)}break;case"suggestions":R.attr("autocomplete","off").attr("autofill","off");R.off("keydown",OnSuggestionPanelKeydown).off("focus",OnSuggestionInputBoxFocused).off("blur",OnSuggestionInputBoxBlurred);R.parent().children("ul").remove();if(E&&E.length>0){var U='<ul class="list-group suggestions" data-role="listview">';for(V=0;V<E.length;V++){U+='<li class="list-group-item"><a href="#"><h4 class="list-group-item-text"></h4></a></li>'}U+="</ul>";var ad=$(U);ad.children().each(function(c,t){$(t).attr("data-for",m).find("h4").text(E[c])});ad.children().first().addClass("ui-first-child");ad.children().last().addClass("ui-last-child");ad.appendTo(R.parent());ad.find("li").on("click",OnSuggestionPanelClicked);R.on("keydown",OnSuggestionPanelKeydown).on("focus",OnSuggestionInputBoxFocused).on("blur",OnSuggestionInputBoxBlurred)}return;case"help":if(!E){if(!R.is("[data-help-text]")){return}R.closest(".form-group._sys_help").removeClass("_sys_help").find("a._sys_help").remove();R.attr("data-help-text",null);return}if(!R.is("[data-help-text]")){R.closest(".form-group").addClass("_sys_help");(o==="selectmenu"||o==="datetime-input"?R.parent().parent():R.parent()).append('<a class="_sys_help" onclick="HelpMessageDlg(\''+m+"')\">?</a>")}R.attr("data-help-text",E);return}switch(o){case"button":case"dropdown_button":switch(M){case"caption":case"text":var s=R.children("span.caret");if(s.length>0){s.detach()}var n=R.children();R.text(E).prepend(n);R.append(s);return;case"enabled":if(E){R.tooltip("hide").removeClass("disabled").removeAttr("disabled")}else{R.tooltip("hide").addClass("disabled").attr("disabled","disabled")}return;case"icon":var z=R.find("i");if(z.length===0){return}if(z.hasClass("material-icons")){z.text(E);return}var j=z.attr("class").split(" ");for(V in j){if(j[V].substr(0,9)=="otp-snap-"||j[V].substr(0,3)=="fa-"){z.removeClass(j[V])}}if(z.hasClass("fa")){z.addClass("fa-"+E)}else{z.addClass("otp-snap-"+E)}return}break;case"chart":if(cControlProperties.chart.some(function(c){return c[1]==M})){SetChartProperty(m,M,E,true)}return;case"carousel":var f;switch(M){case"pager":R.toggleClass("bxslider-pager",E);f=R.data("carouselSettings");f.pager=!!E;R.data("carouselSettings",f);R.data("carouselObject").reloadSlider(f);return;case"slides":f=R.data("carouselSettings");R.data("carouselObject").destroySlider();R.empty();$.each(E,function(t,ag){var c=$("<li><img></li>");var ah=ag.src||ag;var af=ag.alt||"";ah=ah.toString().match(/^[0-9]+$/)?AddPrefix("get_image.php?img=",ah):ah;c.children("img").attr("src",ah).attr("alt",af).attr("title",af);R.append(c)});var ac=R.bxSlider(f);R.data("carouselObject",ac);return;case"value":if((E>0)&&(E<=R.data("carouselObject").getSlideCount())){R.data("carouselObject").goToSlide(E-1)}return}break;case"checkbox-custom":case"flipswitch-custom":switch(M){case"enabled":R.tooltip("hide").prop("disabled",!E);return;case"readonly":SetControlProp(m,"enabled",!E);return;case"value":R.prop("checked",E===R.attr("data-on-value"));return}break;case"checkbox":case"radiobutton":case"flipswitch":switch(M){case"enabled":R.tooltip("hide").prop("disabled",!E);return;case"readonly":SetControlProp(m,"enabled",!E);return;case"value":R.prop("checked",AsBoolean(E));return}break;case"collapsible":switch(M){case"caption":case"text":R.parent().find('a[href="#'+m+'"]').text(E);return;case"collapsed":if(!R.hasClass("in")!=E){R.closest(".panel").siblings().toggleClass("open",false);R.closest(".panel").toggleClass("open",!E);R.collapse({parent:R.data("parent")}).collapse(E?"hide":"show")}return;case"enabled":if(E){$(R.data("parent")).find('a[href="#'+m+'"]').attr("data-toggle","collapse")}else{$(R.data("parent")).find('a[href="#'+m+'"]').removeAttr("data-toggle")}return}break;case"expandable":switch(M){case"collapsed":case"expanded":if(R.hasClass("open")!=E){if(E){OpenExpandableSet(m)}else{CloseExpandableSet(m)}}return;case"enabled":R.removeClass("disabled");if(!E){R.addClass("disabled")}return}break;case"container":switch(M){case"content":DoAjaxCall2("qu_page.php",{PageID:E,into_page:GetUrlParam("page_id")},"POST",function(c){if((!c)||(c.indexOf("timeline")>=0)||(c.indexOf("ctr-calendar")>=0)||(c.indexOf("includeStream(")>=0)){if($.inArray("moment-with-locales",InitScriptsLoaded)==-1){$('<script src="../moment/moment-with-locales.min.js"><\/script>').appendTo("head");InitScriptsLoaded.push("moment-with-locales")}if($.inArray("vis.min",InitScriptsLoaded)==-1){$('<link rel="stylesheet" type="text/css" href="../vis/vis.min.css" >').appendTo("head");$('<script src="../vis/vis.min.js"><\/script>').appendTo("head");InitScriptsLoaded.push("vis.min")}if(c.indexOf("ctr-calendar")>=0){if($.inArray("fullcalendar.min",InitScriptsLoaded)==-1){$('<link href="../fullcalendar/fullcalendar.min.css" rel="stylesheet">').appendTo("head");$('<script src="../fullcalendar/fullcalendar.min.js"><\/script>').appendTo("head");$('<script src="../fullcalendar/locale-all.js"><\/script>').appendTo("head");$('<script>InitScriptsLoaded.push("fullcalendar.min");<\/script>').appendTo("head");InitScriptsLoaded.push("fullcalendar.min")}}}$("body").off(".SNAPSay@"+R.attr("page_id"));$(R).find("[ctrl_type='container']").each(function(af,ag){$("body").off(".SNAPSay@"+ag.getAttribute("page_id"))});R.html(c);R.attr("page_id",E);try{if(R.find('[ctrl_type="carousel"]').length>0){if($.inArray("jquery.bxslider",InitScriptsLoaded)==-1){$('<script src="../jquery/jquery.bxslider.min.js"><\/script>').appendTo("head");$('<link rel="stylesheet" type="text/css" href="../jquery/jquery.bxslider.css" >').appendTo("head");InitScriptsLoaded.push("jquery.bxslider")}}}catch(t){SnapSysError("Error in container - carousel",t)}try{if(R.find('[ctrl_type="datetime-input"],[ctrl_type="timeline"],[ctrl_type="ctr-calendar"]').length>0){if($.inArray("moment-with-locales",InitScriptsLoaded)==-1){$('<script src="../moment/moment-with-locales.min.js"><\/script>').appendTo("head");InitScriptsLoaded.push("moment-with-locales")}}}catch(t){SnapSysError("Error in container - moment-with-locales",t)}try{if(R.find('[ctrl_type="timeline"]').length>0){$('[ctrl_type="timeline"]').each(function(){try{var af=new vis.Timeline($(this)[0],$(this).data("timelineItems"),$(this).data("timelineGroups"),$(this).data("timelineOptions"));$(this).data("timelineObject",af);af.setOptions({zoomable:false});if(navigator.userAgent.indexOf("MSIE")!==-1){af.on("click",function(ah){if(ah.item){af.setSelection([ah.item])}else{af.setSelection([])}})}}catch(ag){SnapSysError("Error initializing .timeline#"+$(this).id+" ",ag)}})}}catch(t){SnapSysError("Error in container - timeline",t)}try{if(R.find('[ctrl_type="rich-text"]').length>0){if($.inArray("ckeditor.min",InitScriptsLoaded)==-1){$('<script src="../ckeditor/ckeditor.js"><\/script>').appendTo("head");InitScriptsLoaded.push("ckeditor.min")}}}catch(t){SnapSysError("Error in container - rich-text",t)}try{if(R.find('[ctrl_type="datatable"]').length>0){if($.inArray("datatables",InitScriptsLoaded)==-1){$('<script src="../DataTables/datatables.min.js"><\/script>').appendTo("head");$('<link rel="stylesheet" type="text/css" href="../DataTables/datatables.min.css" >').appendTo("head");InitScriptsLoaded.push("datatables")}R.find("table").trigger("initDT",[null,null,null])}}catch(t){SnapSysError("Error in container initDT",t)}try{if(R.find('[ctrl_type="chart"]').length>0){if($.inArray("Chart",InitScriptsLoaded)==-1){$('<script src="../Chart/Chart.min.js"><\/script>').appendTo("head");InitScriptsLoaded.push("Chart")}R.find("canvas").trigger("initCHART")}}catch(t){SnapSysError("Error in container initCHART",t)}try{if(R.find('[ctrl_type="selectmenu"]').length>0){if($.inArray("bootstrap-select",InitScriptsLoaded)==-1){$('<link href="../selectpicker/bootstrap-select.min.css" rel="stylesheet" type="text/css">').appendTo("head");$('<script src="../selectpicker/bootstrap-select.min.js"><\/script>').appendTo("head");InitScriptsLoaded.push("bootstrap-select")}}R.find('input,textarea,[ctrl_type="selectmenu"]').trigger("initREQUIRED").trigger("initshiwa")}catch(t){SnapSysError("Error in container initREQUIRED",t)}try{if(R.find('[ctrl_type="datetime-input"]').length>0){if($.inArray("bootstrap-datetimepicker-custom",InitScriptsLoaded)==-1){$('<link rel="stylesheet" type="text/css" href="../datetimepicker-bootstrap/css/bootstrap-datetimepicker-custom.min.css" >').appendTo("head");$('<script src="../datetimepicker-bootstrap/js/bootstrap-datetimepicker-custom.min.js"><\/script>').appendTo("head");InitScriptsLoaded.push("bootstrap-datetimepicker-custom")}R.find('[ctrl_type="datetime-input"]').trigger("initDTP")}}catch(t){SnapSysError("Error in container - datetime-input",t)}R.find(".bxslider.bxslider-captions img").each(function(){$(this).attr("title",$(this).attr("alt"))});R.find(".bxslider").each(function(){var af=$(this).attr("id");var ah={auto:$(this).hasClass("bxslider-auto"),pause:$(this).attr("bxslider-pause"),captions:$(this).hasClass("bxslider-captions"),pager:$(this).hasClass("bxslider-pager"),controls:$(this).hasClass("bxslider-controls"),onSlideAfter:function(){$("#"+af).trigger("control_change")},maxSlides:$(this).attr("bxslider-maxslides"),slideWidth:$(this).attr("bxslider-maxslides")?$("body").width()/$(this).attr("bxslider-maxslides"):0,moveSlides:1};var ag=$(this).bxSlider(ah);$(this).data("carouselObject",ag);$(this).data("carouselSettings",ah)});R.find('[data-tooltip="true"],[data-toggle="tooltip"]').tooltip();if(R.find("select").length){R.find("select").selectpicker("refresh")}R.find("input[data-inputmask]").inputmask();R.find("input[maxlength]").each(function(){$(this).parent().css("max-width",(Number($(this).attr("maxlength"))+2)+"ex")})},function(c){RunTimeError("container error:",c)},null,null,null,{dataType:"html"});return}break;case"main":switch(M){case"title":R.attr("data-page_title",E);if(GetControlProp(m,"visible")){SetWindowTitle(E)}return}break;case"section":case"advsection":case"controlgroup-radio":switch(M){case"enabled":var u=R.hasClass("hidden");R.addClass("hidden").find(cDisablableControlsSelector).filter("[id]").each(function(){SetControlProp($(this).attr("id"),M,E)});R.toggleClass("ui-state-disabled",!E).toggleClass("hidden",u);return;case"readonly":SetReadonly(R,!!E);return;case"hollowed":if(o!=="advsection"){break}if(E&&!R.data("stash")){var P=R.children().detach();R.data("stash",P)}else{if(!E&&R.data("stash")){R.append(R.data("stash"));R.data("stash",null)}}return;case"value":if(E==null){R.find('input[type="radio"]').each(function(){$(this).prop("checked",false)})}else{R.find('input[value="'+E+'"]').prop("checked",true)}return}break;case"collapsible-set":switch(M){case"enabled":R.find(cDisablableControlsSelector).each(function(){SetControlProp($(this).attr("id"),"enabled",E)});R.toggleClass("ui-state-disabled",!E);return}break;case"fragment":switch(M){case"content":R.html(E);return}break;case"icon":switch(M){case"icon":R.text(E);return}break;case"otp-icon":switch(M){case"icon":$.each(R.attr("class").split(" "),function(c,t){if((t.indexOf("poc-")===0||t.indexOf("otp-snap-")===0)){R.removeClass(t)}});if(E.indexOf("poc-")===0){R.addClass(E).addClass("poc-icon")}else{R.addClass("otp-snap-"+E)}return}break;case"telekom-icon":switch(M){case"icon":$.each(R.attr("class").split(" "),function(c,t){if(t.indexOf("t-icon-")===0){R.removeClass(t)}});R.addClass("t-icon-"+E);return}break;case"fa-icon":switch(M){case"icon":$.each(R.attr("class").split(" "),function(c,t){if(t.indexOf("fa-")===0){R.removeClass(t)}});R.addClass("fa-"+E);return}break;case"input-file":switch(M){case"enabled":R.tooltip("hide").attr("disabled",!E);return;case"files":R.val(null).change();return}break;case"input-color":case"input-date":case"input-datetime":case"input-datetime-local":case"input-month":case"input-number":case"input-tel":case"input-time":case"input-search":case"input-url":case"input-week":switch(M){case"enabled":R.tooltip("hide").attr("disabled",!E);return;case"placeholder":R.attr("placeholder",E);return;case"readonly":R.prop("readonly",!!E);return;case"value":R.trigger("control_valuechanged");if(E instanceof Date){switch(o){case"input-date":R.val(E.toISOString().substr(0,10));return;case"input-time":R.val(E.toISOString().substr(11,8));return;case"input-datetime-local":R.val(E.toISOString().substr(0,19));return;default:R.val(E.toISOString());return}}else{if(o==="input-color"){R.val(NormalizeColor(E))}else{R.val(E)}}return}break;case"datetime-input":var x=R.parent().data("DateTimePicker");switch(M){case"enabled":R.tooltip("hide").attr("disabled",!E);return;case"readonly":R.prop("readonly",!!E);return;case"value":if(E instanceof Date){x.date(E)}else{if(E===null||E==""||E==0){x.clear()}else{var y=R.attr("data-io-format");if(y=="default"){x.date(moment(E))}else{if(y=="YYMMDD"&&E.length==5){E="0"+E}x.date(moment(E,y))}}}return;case"minDate":x.minDate(E);return;case"maxDate":x.maxDate(E);return;case"enabledDates":x.enabledDates(E);return;case"disabledDates":x.disabledDates(E);return;case"enabledHours":x.enabledHours(E);return;case"disabledHours":x.disabledHours(E);return;case"placeholder":R.attr("placeholder",E);return}break;case"ctr-calendar":switch(M){case"enabled":R.fullCalendar("option","editable",E);R.fullCalendar("option","selectable",E);R.find("button").each(function(){$(this).prop("disabled",!E)});R.toggleClass("ui-state-disabled",!E);return;case"value":R.fullCalendar("removeEventSources");R.fullCalendar("removeEvents");if(E){R.fullCalendar("addEventSource",E)}return;case"currentDate":R.fullCalendar("gotoDate",E);return;case"hiddenDays":case"businessHours":case"weekNumbers":case"validRange":case"navLinks":R.fullCalendar("option",M,E);return;case"view":R.fullCalendar("changeView",E);return}break;case"rich-text":switch(M){case"readonly":R.toggleClass("snap-readonly",!!E);R.data("ckeditor").setReadOnly(!!E);return;case"value":R.data("ckeditor").setData(E.toString());return}break;case"image":switch(M){case"image":if(!E){R.attr("src","get_image.php?img=0")}else{if(parseInt(E)){R.attr("src","get_image.php?img="+E)}else{R.attr("src",RelURLFromSNAP(E))}}return}break;case"layout_list":switch(M){case"asr_id":case"asr_index":$("#"+m+" > .list-group-item").removeClass("ll-row-selected");if(E){if(R.attr("data-row-selection")=="single"){E=[E[0]]}E.forEach(function(c){$(M=="asr_id"?"#"+c:"#"+m+" > .list-group-item[_sys_listindex="+c+"]").addClass("ll-row-selected")})}R.trigger(AddPrefix(cAfterRecordSelectedPrefix,m));return;case"fsr_id":SetControlProp(m,"asr_id",[E]);return;case"fsr_index":SetControlProp(m,"asr_index",[E]);return;case"avr_index":case"avr_id":RunTimeError(o+"."+M+" is a read-only property of #"+m+" in #"+R.parent().attr("id"));return;case"page":E=Number(E)||1;LayoutListSetPage(m,E);return;case"readonly":SetReadonly(R,!!E);return;case"value":if(!E){return}if(!$.isArray(E)){RunTimeError(o+" value must be a list for #"+m);return}var b=R.parent(),a=R.prev();R.detach();R.attr("data-count",0);R.children().not("._sys_list_template").not("._sys_list_control").remove();var g=R.children("._sys_list_template");if(!g.attr("layout_record_field_name")){g.find("[ctrl_type][id]").each(function(){var c=$(this);if(!c.attr("layout_record_field_name")){c.attr("layout_record_field_name",c.attr("id"))}});g.attr("layout_record_field_name",g.attr("id"))}g.find("input[data-inputmask]").inputmask("remove");if(g.find("table.dataTable").length>0){g.find("table.dataTable").DataTable().destroy()}var d=g.find("[name]").length,e=g.find("label[for]").length,v=g.find('[id^="'+cInvalidationMessagePrefix+'"]').length,A=g.find("input[aria-describedby]").length,Z=g.find('[data-toggle="collapse"]').length,B=g.find("div[data-parent]").length,L=g.find("table").length,r=g.find("canvas").length,K=g.find("div.date").length,O=g.find("a[role=tab]").length,I=g.find('[data-tooltip="true"],[data-toggle="tooltip"]').length;ab=R.attr("layout_record_field_name")||R.attr("id");var X=1;E.forEach(function(af){var t=g.clone(true);t.removeClass("_sys_list_template");t.addClass(cInListClass);var c=AddPrefix(cListItemPrefix,g_nextListItemIndex++);t.attr("id",c).attr("_sys_listindex",X++);t.find("[ctrl_type]").each(function(){var am=this.id;var ah=AddPrefix(c+"_",am);this.id=ah;if(d){t.find('[name="'+am+'"]').attr("name",ah)}if(e){t.find('label[for="'+am+'"]').attr("for",ah)}if(v){t.find("#"+AddPrefix(cInvalidationMessagePrefix,am)).attr("id",AddPrefix(cInvalidationMessagePrefix,ah))}if(A){t.find('input[aria-describedby="'+AddPrefix(cInvalidationMessagePrefix,am)+'"]').attr("aria-describedby",AddPrefix(cInvalidationMessagePrefix,ah))}if(Z){t.find('a[data-toggle="collapse"][href="#'+am+'"]').attr("href","#"+ah)}if(B){t.find('div[data-parent="#'+am+'"]').attr("data-parent","#"+ah)}if(O){t.find('[id="ui-id-'+am+'"]').attr("id","ui-id-"+ah);t.find('a[role=tab][href="#ui-id-'+am+'"]').attr("href","#ui-id-"+ah)}if(this.getAttribute("ctrl_type")=="selectmenu"){var al=$(this);var ak=al.data("selectpicker");if(ak){if(ak.destroyLi){ak.destroyLi()}ak.$button.hide();var aj=ak.options;var ag=$.fn.selectpicker.Constructor;var ai=$.extend({},ag.DEFAULTS,$.fn.selectpicker.defaults||{},al.data(),aj);ai.template=$.extend({},ag.DEFAULTS.template,$.fn.selectpicker.defaults?$.fn.selectpicker.defaults.template:{},al.data().template,aj.template);al.data("selectpicker",new ag(this,ai,null));al.parent().parent().children("button").hide()}}});R.append(t)});if(I){R.find('div[_sys_listindex] [data-tooltip="true"],div[_sys_listindex] [data-toggle="tooltip"]').tooltip()}if(K){R.find("div[_sys_listindex] div.date").trigger("initDTP")}if(a.length){a.after(R)}else{R.prependTo(b)}if(L){R.find("div[_sys_listindex] table").trigger("initDT",[null,null,null])}if(r){R.find("div[_sys_listindex] canvas").trigger("initCHART")}R.find("input[data-inputmask]").inputmask();var q=$("#"+m+">div."+cInListClass);E.forEach(function(af,t){var c=q[t].id;SetControlProp(c,M,af);R.attr("data-count",t+1);R.trigger(AddPrefix(cAfterAppendRecordEventPrefix,ab),c)});R.attr("data-items",E.length);InitLayoutListExtras(R);return}break;case"layout_record":switch(M){case"listindex":RunTimeError(o+"."+M+" is a read-only property of #"+m+" in #"+R.parent().attr("id"));return;case"readonly":SetReadonly(R,!!E);return;case"value":if(E==null){return}if(typeof E!=="object"){RunTimeError(o+" value must be a record for #"+m);return}var H=R.find("[ctrl_type]");while(H.length){var l=H[0];var J=l.getAttribute("ctrl_type");ab=l.getAttribute("layout_record_field_name")||l.getAttribute("id");if(ab in E){SetControlProp(l.id,ReplaceValueProp(J,M),E[ab])}if(J=="layout_list"||J=="layout_record"){H=H.not("#"+l.id+" *[ctrl_type]")}H=H.not(l)}return}break;case"panel":switch(M){case"enabled":R.find(cDisablableControlsSelector).each(function(){SetControlProp($(this).attr("id"),"enabled",E)});R.toggleClass("ui-state-disabled",!E);return;case"header":R.find(".panel-heading").remove();if(!E){return}var aa=$('<div class="panel-heading">');$('<h3 class="panel-title"></h3>').text(E).appendTo(aa);aa.prependTo(R);return;case"footer":R.find(".panel-footer").remove();if(!E){return}$('<div class="panel-footer"></div>').text(E).appendTo(R);return}break;case"range-input":switch(M){case"enabled":R.tooltip("hide").prop("disabled",!E).trigger("updateRanges");return;case"max":case"min":case"step":R.attr(M,E).trigger("updateRanges");return;case"value":R.val(E);R.trigger("updateRanges");return}break;case"selectmenu":switch(M){case"display":var S=[];if(!R.attr("multiple")){R.children("option").each(function(){if($(this).text()==E){S=$(this).attr("value");return false}return true})}else{if(!Array.isArray(E)){E=[E]}R.children("option").each(function(){if(E.indexOf($(this).text())>=0){S.push($(this).attr("value"))}})}R.val(S);R.data("selectpicker")&&R.data("selectpicker").val(S);return;case"readonly":SetControlProp(m,"enabled",!E);return;case"enabled":$('.dropdown-toggle[data-id="'+m+'"]').attr("disabled",!E);R.attr("disabled",!E);R.selectpicker&&R.selectpicker("refresh");R.tooltip("hide").attr("disabled",!E);return;case"options":R.empty();$.each(E||[],function(af,c){var t=$("<option>");if(c.value!==undefined){t.attr("value",c.value)}if(c.selected){t.attr("selected","")}if(c.enabled!==undefined&&!c.enabled){t.attr("disabled","")}if(c.visible!==undefined&&!c.visible){t.addClass("hidden")}if(c.placeholder){t.attr("data-placeholder",true)}if(c.subtext){t.attr("data-subtext",c.subtext)}if(c.display){t.text(c.display)}R.append(t)});if(R.attr("data-livesearch")=="true"&&E.length==0){R.append($('<option data-placeholder="true">'))}R.selectpicker("refresh");return;case"placeholder":if(!E){R.children('option[data-placeholder="true"]').remove()}else{R.children('option[data-placeholder="true"]').text(E)}R.trigger("updateSelects");R.selectpicker("refresh");return;case"search":R.filter("[data-livesearch]").closest(".bootstrap-select").find(".bs-searchbox>input:visible").val(E);return;case"value":R.val(E);R.data("selectpicker")&&R.data("selectpicker").val(E);return}break;case"datatable":switch(M){case"enabled":R.parents("div.dataTables_wrapper").first().toggleClass("disabled",!E);$('input[aria-controls="'+m+'"],select[aria-controls="'+m+'"]').attr("disabled",!E);R.attr("disabled",!E);return;case"selected_rows":RunTimeError(o+"."+M+" is a read-only property of #"+m);return;case"order":var h=R.DataTable();h.order(E);if(R.find(".group-start").length||R.find(".group-end").length){h.rowGroup().dataSrc(R.find("th").eq(E[0][0]).attr("id"))}h.draw();return;case"page":R.DataTable().page(E-1).draw(false);if(R.find(".dataTables_paginate").length==0){window.setTimeout(function(){R.DataTable().page(E-1).draw(false)},1)}return;case"value":if(E!==null&&!$.isArray(E)){RunTimeError("datatable.value must be an array or null.");return}if(E===null){E=[]}R.DataTable().clear().rows.add(E);R.removeClass("snap-recalc-ok");RecalcControls(R,false);return}break;case"datatable_header":switch(M){case"value":case"caption":E=E||"";var Q=(W?$(W):R.parents("table").first()).DataTable();var k=Q.settings()[0].aoColumns[Q.column("#"+m).index()];if(!k){return}k.sTitle=E;$(Q.column(Q.column("#"+m).index()).header()).text(E);Q.draw(false);return}break;case"text":switch(M){case"caption":case"text":R.text(E);return;case"clickable":R.toggleClass("snap_clickable_text",E);return}break;case"dataholder":case"input-email":case"input-hidden":case"input-password":case"input-text":case"textarea-input":switch(M){case"enabled":R.tooltip("hide").prop("disabled",!E);return;case"placeholder":R.attr("placeholder",E);return;case"readonly":R.prop("readonly",!!E);return;case"value":SetTextFieldValue2(R,E);return}break;case"progress":var C;if(R.hasClass("progress")){var N=R.children(".progress-bar");N.attr(M=="value"?"aria-valuenow":"aria-valuemax",E);C=Math.floor(100*N.attr("aria-valuenow")/N.attr("aria-valuemax"));N.attr("style","width: "+C+"%;");if(N.attr("show-value")!=="hide"){N.html(parseInt(E))}}else{R.prop(M,E);C=Math.floor(100*R.prop("value")/R.prop("max"))}R.trigger("updateProgress",C);return;case"listview":switch(M){case"list_items":ArrayToListView(E,m);return}break;case"listitem":switch(M){case"aside":R.closest("li").find("span").remove();$('<span class="badge">').text(E).prependTo(R.is("li")?R:R.parent());return;case"caption":R.children("p").remove();$('<p class="list-group-item-text">').text(E).appendTo(R);return;case"header":R.children("h4").remove();var w=$('<h4 class="list-group-item-heading">').text(E);if(R.children("span").length>0){w.insertAfter(R.children("span"))}else{w.prependTo(R)}return}case"tabitem":switch(M){case"active":if(E){R.siblings().removeClass("active");R.addClass("active");var F="ui-id-"+R.attr("id");R.parent().next().children(".tab-pane").each(function(t,af){var c=$(af);c.toggleClass("active in",c.attr("id")==F)});RecalcControls(R.parent().next().children(".tab-pane#"+F))}else{if(R.hasClass("active")){SetControlProp(R.siblings(":not([id~="+m+"]):not(.hidden)").first().attr("id"),"active",true)}}return;case"caption":R.children("a").text(E);return;case"enabled":R.toggleClass("disabled",!E);return}break;case"timeline":switch(M){case"selection":R.data("timelineObject").setSelection(E);return;case"center":if(E.constructor==Date){R.data("timelineObject").moveTo(E)}else{R.data("timelineObject").focus(E)}return;case"range":R.data("timelineObject").setWindow(E);return;case"items":R.data("timelineItems",E);R.data("timelineObject").setItems(E);return;case"groups":R.data("timelineGroups",E);R.data("timelineObject").setGroups(E);return;case"options":R.data("timelineOptions",E);R.data("timelineObject").setOptions(E);return}break;case"google_map":case"google_map_streetview":switch(M){case"mapType":let map=R[0].gMap;if(map){let mapTypes=["roadmap","terrain","satellite","hybrid","streetview"];if(mapTypes.includes(E)&&mapTypes.includes(map.mapTypeId)){if(map.mapTypeId==="streetview"&&E!=="streetview"&&o!=="google_map_streetview"){map.getStreetView().setVisible(false);map.setMapTypeId(E)}else{if(map.mapTypeId!=="streetview"&&E==="streetview"){map.setMapTypeId(E);map.getStreetView().setVisible(true);map.getStreetView().setPosition({lat:map.markers[0].getPosition().lat(),lng:map.markers[0].getPosition().lng()})}else{if(map.mapTypeId!=="streetview"&&E!=="streetview"){map.setMapTypeId(E)}}}}}return;case"locations":if(E&&R[0].gMap){if(R[0].gMap.markers){for(let V=0;V<R[0].gMap.markers.length;V++){R[0].gMap.markers[V].setMap(null)}}if(E instanceof Array){if(R[0].gMap.mapTypeId==="streetview"){E=getFirstValidLocationForStreetview(E)}else{E=removeEmptyLocationItems(E)}}if(typeof E==="object"&&!E.length){let p=convertObjectLocationParameters(E);E=[p]}if(typeof E==="string"){let p=convertStringLocation(E);E=[p]}let map=R[0].gMap;map.markers=[];map.markerParameters=[];map.defaultZoom=14;let pinAnimation=R.attr("data-animation");let bounds=new google.maps.LatLngBounds();if(E){for(let number=0;number<E.length;number++){if(E[number]){let parameters=E[number];let markerParameter={address:parameters.address,infowindow:parameters.infowindow,latitude:parameters.latitude,longitude:parameters.longitude,markertype:parameters.markertype,heading:parameters.heading,pitch:parameters.pitch,order:number};map.markerParameters.push(markerParameter);if(parameters.latitude!=null&&parameters.longitude!=null){let location={latitude:parameters.latitude,longitude:parameters.longitude};if(parameters.infowindow){location.infowindow=parameters.infowindow}if(parameters.address){location.address=parameters.address}SetMarkers(location,map,pinAnimation,m,parameters,bounds,number)}else{if(parameters.address){getAddress(parameters.address,map,pinAnimation,m,parameters,bounds,number)}else{RunTimeError("No address or incorrect coordinates had been set.")}}}}}R.attr("data-address",JSON.stringify(E));return}else{RunTimeError("Incorrect values had been set.");return}case"height":R[0].style.height=E+"px";return;case"zoom":if(R[0].gMap){let currentMap=document.getElementById(m).gMap;let lastMarker=getLastMarker(currentMap.markers);currentMap.setZoom(E);if(lastMarker){currentMap.setCenter(lastMarker.getPosition())}}return}break}RunTimeError("SetControlProp: "+o+"."+M+" is not handled for #"+m)}function SetReadonly(c,b){var a=c.hasClass("hidden");c.addClass("hidden").find(cReadOnlyControlsSelector).filter("[id]").each(function(){SetControlProp(this.id,"readonly",b)});c.toggleClass("snap-readonly",b).toggleClass("hidden",a)}function GetControlAttr(b,a){if(!b){return undefined}if(b=="?"){return undefined}if(!a){return undefined}return $("#"+b).attr(a)}function SetControlAttr(c,a,b){if(!c){return}if(c=="?"){return}if(!a){return}$("#"+c).attr(a,b)}function HasPrefix(b,a){return a.substr(0,b.length)==b}function AddPrefix(b,a){return b+a}function DelPrefix(b,a){if(HasPrefix(b,a)){return a.substr(b.length)}else{return a}}function GetUrlParam(a){if(g_TopFrame&&g_TopFrame.g_UrlParams){return g_TopFrame.g_UrlParams[a]||null}return null}function GetFrameUrlParam(a){return document.pageParams[a]}function SubstituteIntoText(b,a){Object.keys(b).forEach(function(c){a=a.split("{"+c+"}").join(b[c])});return a}function randomGUID(){var b="........-....-4...-8...-............";var a="";for(var c in b){if(b[c]=="."){a+=(Math.floor(16*Math.random())).toString(16)}else{a+=b[c]}}return a}var AJAXCounter=0;function ShowSpinner(){if((typeof AJAXCounter!=="number")||(++AJAXCounter>0)){$("#ajax_loader").show();if(window.frameElement.name=="M"){SetSessionValue("_sys_suba_middle_frame_is_busy","true")}}}function HideSpinner(){if((typeof AJAXCounter!=="number")||(--AJAXCounter<=0)){AJAXCounter=0;$("#ajax_loader").hide();if(window.frameElement.name=="M"){SetSessionValue("_sys_suba_middle_frame_is_busy","false")}}}function DoAjaxCall2(e,b,j,k,h,d,g,f,a){var c={cache:false,dataType:"json",data:b,type:j,timeout:(g||20)*1000,beforeSend:function(l){ShowSpinner();$.each(d||{},function(n,m){l.setRequestHeader(n,m)})},complete:HideSpinner,success:k,error:function(l,n,m){AjaxError("DoAjaxCall2",l,n,m);if(n==="timeout"){if(typeof f=="function"){f()}}else{h(l)}}};$.extend(c,a||{});SecureAJAX(e,c)}function DoAjaxFileUpload(b,c,a,d){var e=new FormData();e.append("file",$("#"+d).prop("files")[0]);e.append("params",c);SecureAJAX(b,{dataType:"json",data:e,async:true,cache:false,contentType:false,processData:false,beforeSend:ShowSpinner,complete:HideSpinner,success:a})}function DoAjaxFileUpload2(c,d,e,a,b){var f=new FormData();f.append("file",$("#"+e).prop("files")[0]);f.append("params",JSON.stringify(d));SecureAJAX(c,{dataType:"json",data:f,async:true,cache:false,contentType:false,processData:false,beforeSend:ShowSpinner,complete:HideSpinner,success:a,error:b})}function DoOtherUserInfo(a,d,b,c){SecureAJAX("get_user_info.php",{dataType:"json",data:{user:a,pass:d},timeout:20000,beforeSend:ShowSpinner,complete:HideSpinner,success:function(e){if("msg" in e){c(e.msg)}else{if("ok" in e){b(e.ok)}}}})}function GetHostCallValue(h,c){var m,j,l;if(c){m={}}var d=Control_type(h);var g="";if(h.indexOf(".")>-1){g="#"+h.substring(0,h.indexOf("."));h=h.split(".").pop();j=$(g+" th#"+h)}else{j=$("#"+h);if(j.length>0){j=j[0]}}if(((j.length==0)&&(d!=="selectmenu"))&&g==""){RunTimeError("GetHostCallValue: #"+h+" does not exist.");return""}switch(d){case"checkbox":case"checkbox-custom":case"flipswitch":case"flipswitch-custom":l=j.checked;if(d=="checkbox-custom"||d=="flipswitch-custom"){l=$(j).attr(l?"data-on-value":"data-off-value")}if(c){m[j.name]=l}else{m=l}return m;case"radiobutton":if(c){m[h]=!!$(j).prop("checked");if(j.checked){m[j.name]=j.value}}else{m=!!$(j).prop("checked")}return m;case"input-color":case"input-number":case"range-input":case"input-tel":case"input-url":case"input-email":case"input-hidden":case"input-datetime":case"input-datetime-local":case"input-date":case"input-time":if(c){m[j.name]=GetTextFieldValue(h)}else{m=GetTextFieldValue(h)}return m;case"datetime-input":if($("#"+h).attr("data-io-format")=="default"){if($("#"+h).parent().data("DateTimePicker").date()!=null){l=$("#"+h).parent().data("DateTimePicker").date().toDate().toISOString().split(".")[0]+"Z"}else{l=""}}else{var k=$("#"+h).attr("data-io-format");l=$("#"+h).parent().data("DateTimePicker").date()!=null?$("#"+h).parent().data("DateTimePicker").date().format(k):""}if(c){m[j.name]=l}else{m=l}return m;case"ctr-calendar":l=ProcessCalEvents($("#"+h).fullCalendar("clientEvents"),true);if(c){m[h]=l}else{m=l}return m;case"rich-text":l=$("#"+h).data("ckeditor").getData();if(c){m[h]=l}else{m=l}return m;case"input-password":case"input-text":case"textarea-input":case"selectmenu":if(c){m[j.name]=GetTextFieldValue(h)||""}else{m=GetTextFieldValue(h)||""}return m;case"input-file":if(c){m[j.name]=j.files[0]}else{m=j.files[0]}return m;case"layout_list":case"layout_record":case"value":m=(d=="layout_list")?[]:{};var b=(d=="layout_list")?$("#"+h).children():$("#"+h+" *[ctrl_type]");b=b.not("table").not("th").not('[ctrl_type="text"]');while(b.length){var a=b[0];var e=a.getAttribute("ctrl_type");if(!a.classList.contains("_sys_list_template")){var f=ReplaceValueProp(e,"value");if(ControlTypeHasProp(e,f)){if(d=="layout_list"){m.push(GetHostCallValue(a.id,false))}else{m[a.getAttribute("layout_record_field_name")||a.getAttribute("id")]=GetHostCallValue(a.id,false)}}if(e=="layout_list"||e=="layout_record"){b=b.not("#"+a.id+" *[ctrl_type]")}}b=b.not(a)}return m;case"controlgroup-radio":j=$("#"+h);l=null;j.find('input[type="radio"]').each(function(){if($(this).prop("checked")){l=this.value;return false}return true});if(c){m[h]=l}else{m=l}return m;default:l=GetControlProp(h,ReplaceValueProp(d,"value"));if(c){m[h]=l}else{m=l}return m}}function HostCall(g,d,b,c,e,a,f){HostCall2(d,b,c,e,a,f)}function HostCall2(j,o,h,f,s,g,l){var k=new FormData();var m={};if((typeof $HostCallData!=="undefined")&&(j in $HostCallData)&&("id" in $HostCallData[j])){$.each($HostCallData[j]["id"],function(w,x){if(($('div[id="'+x+'"][ctrl_type="ctr-calendar"]').is("div")||($('div[id="'+x+'"][ctrl_type="layout_list"]').is("div")))){k.append(x,JSON.stringify(GetHostCallValue(x,false)))}else{if($("#"+x).is('[ctrl_type="rich-text"]')){k.append(x,GetHostCallValue(x,false))}else{if(Control_type(x)==="layout_record"){var v=GetHostCallValue(x,true);k.append(x,JSON.stringify(v))}else{var v=GetHostCallValue(x,true);$.each(v,function(y,z){k.append(y,z)})}}}})}else{var a=$("#thePage");var d=a.find(":input:disabled").removeAttr("disabled");var n=a.find(':input[name]:not([layout_record_field_name],[ctrl_type="dataholder"])');var u=a.find('div[id][ctrl_type="layout_list"]:not([layout_record_field_name])');var t=a.find('div[id][ctrl_type="ctr-calendar"]:not([layout_record_field_name])');var r=a.find('div[id][ctrl_type="rich-text"]:not([layout_record_field_name])');d.attr("disabled","disabled");n.each(function(){if(!this.id){return}var v=GetHostCallValue(this.id,true);$.each(v,function(w,x){k.append(w,x)})});u.each(function(){k.append(this.id,JSON.stringify(GetHostCallValue(this.id,false)))});t.each(function(){k.append(this.id,JSON.stringify(GetHostCallValue(this.id,false)))});r.each(function(){k.append(this.id,GetHostCallValue(this.id,false))})}if((typeof $HostCallData!=="undefined")&&(j in $HostCallData)&&("variable" in $HostCallData[j])){$.each($HostCallData[j]["variable"],function(w,v){m[v]=window[v]})}k.append("_sys_language",GetLanguage());k.append("_sys_Variables",JSON.stringify(m));k.append("_sys_MapperID",j);k.append("_sys_TabID",g_TopFrame.g_tabId);if(GetUrlParam("mockws")||window.top.g_useMockWS){k.append("_sys_MockWS",true);var q="_sys_page_editor",c="0";if(g_TopFrame&&g_TopFrame.GetTestCaseTitle){q=g_TopFrame.GetTestCaseTitle()}if(GetUrlParam("page_id")){c=GetUrlParam("page_id")}var b=window.top.location.search.match(/[?&]ItemID=([0-9]+)(&|$)/);if(b!==null&&b.length>=2){c=b[1]}k.append("_sys_TestSuiteID",c);k.append("_sys_TestCaseName",q)}var e;DoConsoleLog("HostCall2: "+j);SecureAJAX("./mapper/process.php",{cache:false,dataType:"json",data:k,contentType:false,processData:false,timeout:s*1000,async:g,beforeSend:(l?ShowSpinner:null),complete:(l?HideSpinner:null),success:function(y){var x=y;var w=[];var v=[];if(y.Language!==undefined){SetLanguage(y.Language)}if(y.CtrlValue!==undefined){x=y.CtrlValue}if(y.SessionVariable!==undefined){w=y.SessionVariable}if(y.ClientVariable!==undefined){v=y.ClientVariable}$.each(w,function(A,z){SetSessionValue(A,z)});$.each(v,function(A,z){window[A]=z});$.each(x,function(D,G){e=D.replace("[]","\\[\\]");e=D.replace(/\./g,"\\.");if($('input[name="'+e+'"]').is(":radio")){$('input:radio[name="'+e+'"]').prop("checked",false);$('input:radio[name="'+e+'"][value="'+G.VALUE+'"]').prop("checked",true)}else{if($("input#"+e).is(":radio")){var A=$("input#"+e).attr("name");$('input:radio[name="'+A+'"]').prop("checked",false);$("#"+e).prop("checked",G.VALUE)}else{if($('input[name="'+e+'"]').is(":checkbox")){if($("#"+e).attr("ctrl_type")=="checkbox-custom"||$("#"+e).attr("ctrl_type")=="flipswitch-custom"){if($("#"+e).attr("data-on-value")==G.VALUE){$("#"+e).prop("checked",true)}else{$("#"+e).prop("checked",false)}}else{$("#"+e).prop("checked",AsBoolean(G.VALUE))}}else{if($('select[name="'+e+'"]').is("select")){var B=$("#"+e);if(G.CONTENT!==undefined){B.empty();$.each(G.CONTENT,function(){B.append($("<option />").val(this.VALUE).text(this.DISPLAY))});B.val("");B.selectpicker("refresh")}if(G.VALUE!==undefined){if($.isArray(G.VALUE)){var F=G.VALUE.toString().split(",");B.val(F);B.data("selectpicker")&&B.data("selectpicker").val(F)}else{B.val(G.VALUE);B.data("selectpicker")&&B.data("selectpicker").val(G.VALUE)}}}else{if($('ul[id="'+e+'"]').is("ul")){var z=$("#"+e);var C=0;if(G.CONTENT!==undefined){z.empty();$.each(G.CONTENT,function(){var H=$("<li/>").addClass("list-group-item").appendTo(z);$("<p/>").text(this.ASIDE).addClass("badge").appendTo(H);var I=$('<a href="#"/>').attr("id",e+"-listitem-"+C).attr("ctrl_type","jqm_listitem").appendTo(H);$("<h4/>").text(this.HEADER).addClass("list-group-item-heading").appendTo(I);$("<p/>").text(this.LISTITEM).addClass("list-group-item-text").appendTo(I);C++});$("#"+e+" > li:last").addClass("ui-last-child");$("#"+e+" > li:first").addClass("ui-first-child")}}else{if($('[ctrl_type="datetime-input"][name="'+e+'"]').is(":input")||$('div[id="'+e+'"][ctrl_type="ctr-calendar"]').is("div")||$("#"+e).is('[ctrl_type="rich-text"]')||$('div[id="'+e+'"][ctrl_type="layout_list"]').is("div")||$('div[ctrl_type="fragment"][id="'+e+'"]').is("div")){SetControlProp(e,"value",G.VALUE)}else{if($('input[name="'+e+'"]').is(":input")||$('textarea[name="'+e+'"]').is("textarea")){SetTextFieldValue(e,G.VALUE)}else{if($('table[id="'+e+'"]').is("table")){try{if(G.VALUE[0].constructor===Array){SetControlProp(e,"value",G.VALUE[0])}else{SetControlProp(e,"value",G.VALUE)}}catch(E){SnapSysError("HostCall table set value error:",E)}}else{if(G.hasOwnProperty("VALUE")){$("#"+e).text(G.VALUE)}}}}}}}}}});o()},error:function(v,x,w){AjaxError("HostCall2",v,x,w);if(v.status===401){OnError401()}if(x==="timeout"){f()}else{h(v)}}})}function ExecuteServerProcess(d,b,c,a){SecureAJAX("./mapper/save_params.php",{data:b,dataType:"json",success:function(e){if(a){window.open(a+"/"+d+"/"+e+(c?"/"+c:""))}else{window.open("mapper/execute_process.php?ID="+d+"&secret="+e)}},error:function(e,g,f){AjaxError("ExecuteServerProcess",e,g,f)}})}function FilterValue(b,a){return FilterValueInner(JSON.parse(JSON.stringify(b)),a.toLowerCase())}function FilterValueInner(h,d){var j,b;if(h===null||h===undefined){return h}if($.isArray(h)){b=[];var g=0,a=h.length;for(;g<a;g++){j=FilterValueInner(h[g],d);if(j!==undefined){b.push(j)}}return b}if($.isPlainObject(h)){b={};var e,c=0;for(e in h){j=FilterValueInner(h[e],d);if($.isArray(j)){b[e]=j;c+=j.length}else{b[e]=h[e];if(j!==undefined){c++}}}return(c>0)?b:undefined}return(h.toString().toLowerCase().indexOf(d)>=0)?h:undefined}function TablesSort(f,d,c){var b=JSON.parse(JSON.stringify(d));var a=c?1:-1;var e=c?-1:1;if(!d){return d}b.sort(function(h,g){if(!(f in h)||!(f in g)){return 0}if((typeof h[f]=="string")&&(typeof g[f]=="string")){var j=h[f].localeCompare(g[f]);return c?-j:j}if(h[f]<g[f]){return a}if(h[f]>g[f]){return e}return 0});return b}function TablesFilter(b,a){if(!b){return b}if(typeof b.__proto__==="unknown"||typeof b.__proto__==="undefined"){b=JSON.parse(JSON.stringify(b))}return b.filter(function(c){return a(c)})}function TablesFindIndex(b,a){if(!b){return 0}if(typeof b.__proto__==="unknown"||typeof b.__proto__==="undefined"){b=JSON.parse(JSON.stringify(b))}return b.findIndex(function(c){return a(c)})+1}function TablesReorder(b,c){if(!b){return b}var a=[];$.each(b,function(d,e){a.push(c(e))});return a}function TablesJoin(k,j,d,b,f){if(!k||k.length==0){return[]}if(!j||j.length==0||!d||!b){if(f){return k}else{return[]}}var e={},c={},h={},g;for(g=0;g<k.length;g++){if(d in k[g]){if(!e[k[g][d]]){e[k[g][d]]=[]}e[k[g][d]].push(k[g])}}for(g=0;g<j.length;g++){if(b in j[g]){if(!c[j[g][b]]){c[j[g][b]]=[]}c[j[g][b]].push(j[g])}}j.forEach(function(l){for(var m in j[l]){h[m]=""}});var a=[];$.each(e,function(m,l){$.each(l,function(o,n){var q=c[m];if(q){$.each(q,function(s,r){a.push($.extend({},n,r))})}else{if(f){a.push($.extend({},n,h))}}})});return a}function TablesAppend(c,g,e){if(!g||g.length===0){return e}if(!e||e.length===0){return g}var l,k;if(c=="A"){l=g;var j=[];for(k in g[0]){j.push(k)}for(var d=0;d<e.length;d++){var b={};for(var a=0;a<j.length;a++){b[j[a]]=e[d][j[a]]||""}l.push(b)}return l}else{if(c=="M"){var h={};for(k in g[0]){h[k]=null}var f={};for(k in e[0]){f[k]=null}l=[];$.each(g,function(){l.push($.extend({},this,f))});$.each(e,function(){l.push($.extend({},h,this))});return l}else{return g.concat(e)}}}function InitDateTimePicker(f){var c=$(f);var g=c.find("input");try{var b=c.closest("._sys_list_template");if(b[0]){return}var a={locale:GetLanguage(),format:g.attr("data-format"),showTodayButton:g.attr("data-today-button")=="true",showClear:g.attr("data-clear-button")=="true",showClose:g.attr("data-close-button")=="true"&&g.attr("data-inline")=="false",focusOnShow:false,useCurrent:false,daysOfWeekDisabled:g.attr("data-disable-weekends")=="true"?[0,6]:[],inline:g.attr("data-inline")=="true"};if(g_LocalizedStrings.DATETIMEPICKER_TOOLTIPS){a.tooltips=g_LocalizedStrings.DATETIMEPICKER_TOOLTIPS}c.datetimepicker(a).on("dp.change",function(){g.trigger("dp.change")});g.on("dp.change",function(h){h.stopPropagation()})}catch(d){SnapSysError("DateTimePicker Init Error",d)}}var layoutListRefs=[];function InitLayoutListExtras(a){if($(a).parent("._sys_list_template")[0]){return}var c=$(a).attr("id");var b=$(a).attr("data-items");$("#"+c+" > .list-controls-top").show();if($(a).attr("data-size")=="cards"){LayoutListFixCardNumbers(c,b)}if($(a).hasClass("list-group-table-rowselection")){$("#"+c+" .list-group-item:not(._sys_list_template)").on("mousedown",function(f){if((!$(f.target)[0].hasAttribute("ctrl_type")&&$(f.target).hasClass("form-group"))||$(f.target).is("[readonly]")||$(f.target).attr("ctrl_type")=="text"||f.currentTarget==f.target){var d=$(f.currentTarget);if(d.hasClass("ll-row-selected")){d.removeClass("ll-row-selected")}else{if($(a).attr("data-row-selection")=="single"){$("#"+c+" > .list-group-item").removeClass("ll-row-selected")}d.addClass("ll-row-selected")}d.trigger(AddPrefix(cAfterRecordSelectedPrefix,c))}})}if($(a).attr("data-initialized")!="true"){if($(a).attr("data-size")=="table"){if($(a).attr("data-ordering")=="true"){LayoutListFillOrderSelector(c);LayoutListCreateTableHeader(c,true)}else{LayoutListCreateTableHeader(c,false)}}else{if($(a).attr("data-ordering")=="true"){LayoutListFillOrderSelector(c)}}$(a).attr("data-initialized","true")}if($(a).attr("data-filtering")=="true"){$("#"+c+" .list-controls-top input.form-control").bindWithDelay("keyup",function(){LayoutListFilter(c,$(this).val())},70).attr("title",g_LocalizedStrings.LAYOUT_SEARCH);if($(a).attr("data-filtered")){LayoutListFilter(c,$(a).attr("data-filtered"))}}if(($(a).attr("data-filtering")=="true"||$(a).attr("data-ordering")=="true")||$(a).attr("data-size")=="table"){$("#"+c+" > .list-controls-top").removeClass("hidden")}if($(a).attr("data-paginating")=="true"){LayoutListCreatePagination(c)}else{if($(a).hasClass("list-group-table-striped")){LayoutListApplyStripes(c)}}a.trigger("rendered")}function LayoutListFillOrderSelector(b){var a=GetControlProp(b,"value");$("#"+b+"-order").on("change",function(){LayoutListOrder(b,this)}).empty().append('<option value="0" selected>&udarr;</option>');$.each(a[0],function(d){var c=$("#"+b+" ._sys_list_template").find('[layout_record_field_name="'+d+'"]');if(c[0]){var e=$("#"+b+" ._sys_list_template").find('label[for="'+$(c[0]).attr("id")+'"]');if(e[0]){$("#"+b+"-order").append('<option value="0'+d+'">&darr; '+$(e[0]).html()+"</option>");$("#"+b+"-order").append('<option value="1'+d+'">&uarr; '+$(e[0]).html()+"</option>")}}});if($("#"+b+"-order").children().length<3){RunTimeError("Ordering is enabled for layout list #"+b+", but no child control has a label.")}if($("#"+b+"-order").selectpicker){$("#"+b+"-order").selectpicker("refresh")}}function LayoutListCreateTableHeader(d,b){var a=$("#"+d+" ._sys_list_template .row");var c=$("#"+d+" .snap-ll-header");if(!a[0]){return}if($("#"+d+" ._sys_expandable")[0]){c.addClass("snap-ll-expandable");a=$("#"+d+" ._sys_list_template ._sys_expandable_header .row")}a.each(function(f,j){var h=$(j);var e=$("<div></div>");e.addClass(h.attr("class"));$.each(h.children(".form-group"),function(m,n){var l=$("<div></div>");l.addClass($(n).attr("class"));var k=$(n).find("label")[0];if(k){if(b){var g=$('<a class="ll-order-anchor">'+$(k).html()+"</a>");g.attr("data-order-by",$(k).attr("for"));g.attr("data-order","0");g.on("click",function(){LayoutListOrder(d,this)});l.append(g)}else{l.append($(k).html())}}e.append(l)});c.append(e)})}function LayoutListOrder(g,c){if(!$("#"+g).attr("data-order-by")){layoutListRefs[g]=GetControlProp(g,"value")}var f,b,a,e;if($(c).is("select")){f=$(c).val().substr(1,$(c).val().length);b=$(c).val().substr(0,1)}else{if($(c).is("a")){f=$(c).attr("data-order-by");b=$(c).attr("data-order");$("#"+g+" .ll-order-anchor").attr("data-order",0);switch(b){case"0":$(c).attr("data-order",1);break;case"1":$(c).attr("data-order",2);break;case"2":$(c).attr("data-order",0);f=0;break}}else{return}}a=b==1?1:-1;e=b==1?-1:1;if(f==0){SetControlProp(g,"value",layoutListRefs[g]);$("#"+g).removeAttr("data-order-by");return}$("#"+g).attr("data-order-by",b+f);var d=GetControlProp(g,"value");d.sort(function(j,h){if(j[f]<h[f]){return a}if(j[f]>h[f]){return e}return 0});SetControlProp(g,"value",d);$("#"+g).trigger("rendered")}function LayoutListCreatePagination(c){var b;if(!$("#"+c).attr("data-current-page")){$("#"+c).attr("data-current-page","1")}$("#"+c+" > .list-controls-bottom").remove();var a=$('<div class="_sys_list_control list-controls-bottom text-center"></div>');b=$("#"+c).find('[ctrl_type="layout_record"]').not("._sys_list_template").length;a.append('<div class="dataTables_wrapper" role="group"><div class="dataTables_info" id="'+c+'-ll-info"></div><div class="dataTables_paginate"><a id="'+c+'-ll-prev" class="paginate_button previous" onclick="LayoutListPreviousPage(\''+c+'\')" title="'+g_LocalizedStrings.LAYOUT_PREV_PAGE+'">&larr;</a><span id="'+c+'-ll-pages"></span><a id="'+c+'-ll-next" class="paginate_button next" onclick="LayoutListNextPage(\''+c+'\')" title="'+g_LocalizedStrings.LAYOUT_NEXT_PAGE+'">&rarr;</a></div></div>');if(b!=0){$("#"+c).append(a);LayoutListApplyPagination(c)}}function LayoutListNextPage(d){var c=$("#"+d).attr("data-current-page");var a=parseInt($("#"+d).attr("data-per-page"));var b=$("#"+d).find('[ctrl_type="layout_record"]').not("._sys_list_template").not("hidden-filter").length/a;if(c==b){return}$("#"+d).attr("data-current-page",parseInt(c)+1);LayoutListApplyPagination(d);$("#"+d).trigger("rendered")}function LayoutListPreviousPage(b){var a=$("#"+b).attr("data-current-page");if(a==1){return}$("#"+b).attr("data-current-page",parseInt(a)-1);LayoutListApplyPagination(b);$("#"+b).trigger("rendered")}function LayoutListSetPage(d,c){var a=parseInt($("#"+d).attr("data-per-page"));var b=Math.ceil($("#"+d).find('[ctrl_type="layout_record"]').not("._sys_list_template").not("hidden-filter").length/a);if(c<1||c>b){return}$("#"+d).attr("data-current-page",c);LayoutListApplyPagination(d);$("#"+d).trigger("rendered")}function LayoutListApplyPagination(q){if($("#"+q).attr("data-paginating")!="true"){return}var m,l,k,f,b,s,d,g;var o=parseInt($("#"+q).attr("data-per-page"));m=$("#"+q).children('[ctrl_type="layout_record"]').not("._sys_list_template").not(".hidden-filter");l=$("#"+q).attr("data-current-page");k=Math.ceil(m.length/o);f=$("#"+q).find("#"+q+"-ll-prev");b=$("#"+q).find("#"+q+"-ll-next");s=$("#"+q).find("#"+q+"-ll-info");d=$("#"+q).find("#"+q+"-ll-pages");if(l>k){l=k}var r=l==1?1:((l-1)*o)+1;var j=(r+o);if(m.length==0){r=0;j=1}var n=1;var a=1;$.each(m,function(t,c){$(c).removeClass("even");if(n>=r&&n<j){$(c).removeClass("hidden-pagination");if(a%2!=0){$(c).addClass("even")}a++}else{$(c).addClass("hidden-pagination")}n++});s.text("# "+r+"-"+(j>m.length?m.length:j-1)+" / "+m.length);if(l>1){f.removeClass("disabled").removeAttr("disabled")}else{f.addClass("disabled").attr("disabled","disabled")}if(l<k){b.removeClass("disabled").removeAttr("disabled")}else{b.addClass("disabled").attr("disabled","disabled")}d.empty();if(k<6){for(g=1;g<k+1;g++){d.append('<a class="paginate_button '+(g==l?"current":"")+'" onclick="LayoutListSetPage(\''+q+"',"+g+')" '+LayoutListButtonTitle(g,l)+">"+g+"</a>")}}else{if(l<4){for(g=1;g<5;g++){d.append('<a class="paginate_button '+(g==l?"current":"")+'" onclick="LayoutListSetPage(\''+q+"',"+g+')" '+LayoutListButtonTitle(g,l)+">"+g+"</a>")}d.append('<span class="ellipsis">\u2026</span>');d.append('<a class="paginate_button " onclick="LayoutListSetPage(\''+q+"',"+k+')" '+LayoutListButtonTitle(k,l)+">"+k+"</a>")}else{if(l>k-4){d.append('<a class="paginate_button " onclick="LayoutListSetPage(\''+q+"',1)\" "+LayoutListButtonTitle(1,l)+">1</a>");d.append('<span class="ellipsis">\u2026</span>');for(g=k-4;g<k+1;g++){d.append('<a class="paginate_button '+(g==l?"current":"")+'" onclick="LayoutListSetPage(\''+q+"',"+g+')" '+LayoutListButtonTitle(g,l)+">"+g+"</a>")}}else{var e=parseInt(l-1);var h=parseInt(parseInt(l)+1);d.append('<a class="paginate_button " onclick="LayoutListSetPage(\''+q+"',1)\" "+LayoutListButtonTitle(1,l)+">1</a>");d.append('<span class="ellipsis">\u2026</span>');d.append('<a class="paginate_button previous" onclick="LayoutListSetPage(\''+q+"',"+e+')" title="'+g_LocalizedStrings.LAYOUT_PREV_PAGE+'">'+e+"</a>");d.append('<a class="paginate_button current" onclick="LayoutListSetPage(\''+q+"',"+(l)+')" '+LayoutListButtonTitle(l,l)+">"+(l)+"</a>");d.append('<a class="paginate_button next" onclick="LayoutListSetPage(\''+q+"',"+h+')" title="'+g_LocalizedStrings.LAYOUT_NEXT_PAGE+'">'+h+"</a>");d.append('<span class="ellipsis">\u2026</span>');d.append('<a class="paginate_button" onclick="LayoutListSetPage(\''+q+"',"+k+')" '+LayoutListButtonTitle(k,l)+">"+k+"</a>")}}}}function LayoutListButtonTitle(a,b){if(a==b){return' title="'+g_LocalizedStrings.LAYOUT_CURRENT_PAGE+'"'}else{return' title="'+g_LocalizedStrings.LAYOUT_PAGE_NO.replace("#",a)+'"'}}function LayoutListFilter(b,a){if(a.length>0){$("#"+b).children('[ctrl_type="layout_record"]').not("._sys_list_template").each(function(d,c){$(c).removeClass("hidden-pagination");var e=GetControlProp($(c).attr("id"),"value");if(JSON.stringify(e).toLowerCase().indexOf(a.toLowerCase())!==-1){$(c).removeClass("hidden-filter")}else{$(c).addClass("hidden-filter")}});$("#"+b).attr("data-filtered",a)}else{$("#"+b).removeAttr("data-filtered");$("#"+b).children('[ctrl_type="layout_record"]').not("._sys_list_template").removeClass("hidden-filter")}if($("#"+b).attr("data-paginating")=="true"){LayoutListApplyPagination(b)}else{if($("#"+b).hasClass("list-group-table-striped")){LayoutListApplyStripes(b)}}$("#"+b).trigger("rendered")}function LayoutListApplyStripes(c){var b=1;var a=$("#"+c).children('[ctrl_type="layout_record"]').not("._sys_list_template").not(".hidden-filter");$(a).each(function(e,d){$(d).removeClass("even");if(b%2!=0){$(d).addClass("even")}b++})}function LayoutListGetSelectedRows(c,a){var b=[];$("#"+c+" > .ll-row-selected").each(function(d,f){b.push($(f).attr("id"))});return a=="first"?b[0]:b}function LayoutListFixCardNumbers(d,a){var b=parseInt($("#"+d).attr("data-card-number"));var c=parseInt($("#"+d).attr("data-card-number-current"));if(a>=b||a==0){if(b!=c){$("#"+d).removeClass("snap-card-"+c);$("#"+d).addClass("snap-card-"+b);$("#"+d).attr("data-card-number-current",b)}}else{$("#"+d).removeClass("snap-card-"+b);$("#"+d).removeClass("snap-card-"+c);$("#"+d).attr("data-card-number-current",a);$("#"+d).addClass("snap-card-"+a)}}function RefreshCollapsibleControls(a){RecalcControls($(a),false)}function OnClientActivity(){if(g_TopFrame&&g_TopFrame.OnClientActivity){g_TopFrame.OnClientActivity()}}function OnOnePageLoad(){OnClientActivity();$("*").on("click keydown",OnClientActivity);$("input[data-inputmask]").inputmask();$("input[maxlength]").each(function(){var e;if($(this).attr("ctrl_type")=="datetime-input"){e=(16*Number($(this).attr("maxlength"))+62);$(this).parent().css("max-width",e+"px");if($(this).parent().parent().hasClass("_sys_help")){$(this).parent().parent().find("a._sys_help").css("left",(e+10)+"px").css("right","auto")}else{if($(this).parent().parent().parent().hasClass("_sys_help")){$(this).parent().parent().find("a._sys_help").css("left",(e+20)+"px").css("right","auto")}}}else{e=(16*Number($(this).attr("maxlength"))+26);$(this).css("max-width",e+"px");if($(this).parent().hasClass("_sys_help")){$(this).parent().find("a._sys_help").css("left",(e+10)+"px").css("right","auto")}else{if($(this).parent().parent().hasClass("_sys_help")){$(this).parent().find("a._sys_help").css("left",(e+20)+"px").css("right","auto")}}}});$("select[id]").off("updateSelects").on("updateSelects",function(){$(this).selectpicker("refresh")});$("select[id]").each(function(){var e=!!$(this).attr("data-livesearch");$(this).selectpicker({liveSearch:e,liveSearchNormalize:e,liveSearchPlaceholder:$(this).find("option[data-placeholder]").text(),noneSelectedText:g_LocalizedStrings.SELECTMENU_PLACEHOLDER,noneResultsText:g_LocalizedStrings.SELECTMENU_NO_RESULTS})});$('select[id][data-tooltip],select[id][data-toggle="tooltip"]').each(function(){var e=$(this);var k=e.closest(".visible-wrapper").find("button");$.each(["data-placement","data-original-title"],function(m,l){k.attr(l,e.attr(l))});k.attr("data-tooltip",true);k.attr("title",null)});$('[data-tooltip="true"],[data-toggle="tooltip"]').not("._sys_list_template *").tooltip();$(".panel-heading>i").each(function(){var e=$(this);var m=e.closest(".panel-heading").next();var k=!m.hasClass("in");var l=m.attr(k?"data-collapsed-icon":"data-expanded-icon");e.text(l||"")});var c=$('div[data-role="collapsible"]');c.on("shown.bs.collapse",function(){$(this).prev().children("i").text($(this).attr("data-expanded-icon")||"")});c.on("hidden.bs.collapse",function(){$(this).prev().children("i").text($(this).attr("data-collapsed-icon")||"")});try{if($.fn.dataTable){$.fn.dataTable.ext.errMode="throw";if(window.Intl){var f=new Intl.Collator();var d=$.fn.dataTable.ext.type;delete d.order["string-pre"];d.order["string-asc"]=f.compare;d.order["string-desc"]=function(k,e){return -f.compare(k,e)}}}$("table").trigger("initDT",[null,null,null])}catch(h){SnapSysError("Error in initDT",h)}try{$("div.date").trigger("initDTP")}catch(h){SnapSysError("Error in initDTP",h)}try{$("canvas").trigger("initCHART")}catch(h){SnapSysError("Error in initCHART",h)}try{$('input,textarea,[ctrl_type="selectmenu"]').trigger("initREQUIRED").trigger("initshiwa")}catch(h){SnapSysError("Error in initREQUIRED",h)}try{$('div[ctrl_type="google_map"], div[ctrl_type="google_map_streetview"]').trigger("initMaps")}catch(h){SnapSysError("Error in initMaps",h)}$(".bxslider.bxslider-captions img").each(function(){$(this).attr("title",$(this).attr("alt"))});$(".bxslider").each(function(){var e=$(this).attr("id");var l={auto:$(this).hasClass("bxslider-auto"),pause:$(this).attr("bxslider-pause"),captions:$(this).hasClass("bxslider-captions"),pager:$(this).hasClass("bxslider-pager"),controls:$(this).hasClass("bxslider-controls"),onSlideAfter:function(){$("#"+e).trigger("control_change")},maxSlides:$(this).attr("bxslider-maxslides"),slideWidth:$(this).attr("bxslider-slidewidth")||($(this).attr("bxslider-maxslides")?$("body").width()/$(this).attr("bxslider-maxslides"):0),moveSlides:1};var k=$(this).bxSlider(l);$(this).data("carouselObject",k);$(this).data("carouselSettings",l)});$('[ctrl_type="rich-text"]').each(function(l,m){var n=$(m);var k=CKEDITOR.appendTo(n.attr("id"),{disableNativeSpellChecker:false,readOnly:n.hasClass("snap-readonly")||n.parents().hasClass("snap-readonly"),removeButtons:"Image,About,Anchor,Source,PasteFromWord,SpellChecker,Scayt",removePlugins:"wsc,scayt"});k.on("change",function(){n.trigger("input")});n.data("ckeditor",k)});c.on("shown.bs.collapse",function(k){RecalcControls($(k.target))});$('a[data-toggle="tab"]').on("shown.bs.tab",function(k){RecalcControls($(k.target.hash))});var b=$("div[data-has-reveal-buttons]");if(b.length>0){$('<i class="hidden material-icons snap-reveal-button snap-nav-button" onclick="RevealNavPanel();">menu</button>').prependTo(b);$('<i class="hidden material-icons snap-reveal-button snap-adv-button" onclick="RevealAdvPanel();">more_vert</button>').appendTo(b)}window.addEventListener("resize",OnOnePageResize);OnOnePageResize();$("#thePage").scrollTop(0);$(".snap-disabled :input").prop("disabled",true);$(".snap-readonly :input").prop("readonly",true);$("div.timeline").each(function(){try{var k=new vis.Timeline($(this)[0],$(this).data("timelineItems"),$(this).data("timelineGroups"),$(this).data("timelineOptions"));$(this).data("timelineObject",k);k.setOptions({zoomable:false});if(navigator.userAgent.indexOf("MSIE")!==-1){k.on("click",function(e){if(e.item){k.setSelection([e.item])}else{k.setSelection([])}})}}catch(l){SnapSysError("Error initializing .timeline#"+$(this).id+" ",l)}});$("div.timeline").on("wheel",function(l){if($(this).data("timelineOptions").zoomable===false){return}var k=$(this).data("timelineObject").getWindow();var m=k.end-k.start;if(l.originalEvent.deltaY<0){$(this).data("timelineObject").setWindow(new Date(k.start.getTime()+m/4),new Date(k.end.getTime()-m/4),{animation:{duration:125,easingFunction:"easeInOutQuad"}})}else{$(this).data("timelineObject").setWindow(new Date(k.start.getTime()-m/2),new Date(k.end.getTime()+m/2),{animation:{duration:125,easingFunction:"easeInOutQuad"}})}l.preventDefault()});$("html, body").on("keypress",function(k){if(k.keyCode==13){PerformClickOnShortcut("ENTER",k)}});$("html, body").on("keydown",function(k){if(k.keyCode==27){PerformClickOnShortcut("ESC",k)}});ProcessPageParams();var a=$("html");if(a.data("dictionary")&&typeof a.data("dictionary")==="object"){var g=a.data("dictionary"),j=g_TopFrame.g_defaultLanguage;if(!g[j]){g[j]=({})}$("[id]").each(function(){var m=$(this);var e=m.attr("id");var k=Control_type_of_$(m);if(!k){return}var l=cControlProperties[k]||[];l.forEach(function(o){var n=o[1];if(cLocalizableProperties.indexOf(n)>=0){g[j][e+"."+n]=GetControlProp(e,n)}})});a.data("dictionary",g).attr("lang",g_TopFrame.g_defaultLanguage);SetLanguage($(g_TopFrame.document).children("html").attr("lang"))}ShowSubpage(window.top.location.hash.replace(/#|,.*/g,""));$("#thePage").addClass("in");SetPanelLoaded(Get_sys_FrameNonce(),document.pageID,document.pageName,b.length>0,window.location.search);if(g_TopFrame.g_log_load_times&&window.location.search.indexOf("&panel=M")>-1){$("body").on("init",function(){var e=new Date().getTime()-new Date(performance.timing.navigationStart);SecureAJAX("doPageTimeLog.php",{data:{LoadTime:e,TabID:g_TopFrame.g_tabId}})})}$("body").trigger("init")}function OnOnePageUnload(){$("*").off()}function SumHeights(b){var a=15;$("#theHTML>"+b).each(function(){a+=$(this).height()});return a}function OnOnePageResize(){$(".snap-nav-button").toggleClass("hidden",!GetPanelLoaded("L")||GetPanelUniv("L","visible"));$(".snap-adv-button").toggleClass("hidden",!GetPanelLoaded("R")||GetPanelUniv("R","visible"));$(".bxslider[bxslider-maxslides]").each(function(){var d=$(this).data("carouselObject");var b=$(this).data("carouselSettings");if(!d||!b){return}if(!$(this).attr("bxslider-slidewidth")){b.slideWidth=$(window).width()/$(this).attr("bxslider-maxslides");$(this).find("img").each(function(){$(this).attr("title",$(this).attr("alt"))});d.reloadSlider(b)}});$("table.dataTable").removeClass("snap-recalc-ok");var a=$('#theHTML>[ctrl_type="main"]:not(.hidden)');a.css("padding-top",SumHeights(".navbar-fixed-top")+"px");a.css("padding-bottom",SumHeights(".navbar-fixed-bottom")+"px")}function ShowSubpage(b){var a=$('#theHTML>[ctrl_type="main"]');a.addClass("hidden");if(b&&a.filter("#"+b).length>0){SetControlProp(b,"visible",true);SetWindowTitle($("#"+b).attr("data-page_title")||g_TopFrame.g_IndexTitle)}else{SetControlProp(a.first().attr("id"),"visible",true);SetWindowTitle(a.first().attr("data-page_title")||g_TopFrame.g_IndexTitle)}OnOnePageResize();$("html,body,#thePage").scrollTop(0)}function WebStorage_set(b,a,c){if(b){b.setItem(a,c)}else{g_webStorage[a]=c}}function WebStorage_get(d,b,c){var a;if(d){switch(b){case"CLEAR":d.clear();break;case"GET":return d.getItem(c);case"GET_REMOVE":a=d.getItem(c);d.removeItem(c);return a;case"REMOVE":d.removeItem(c);break}}else{switch(b){case"CLEAR":g_webStorage=[];break;case"GET":return g_webStorage[c];case"GET_REMOVE":a=g_webStorage[c];delete g_webStorage[c];return a;case"REMOVE":delete g_webStorage[c];break}}}function NormalizeColor(b){if(b.match(/^#[0-9A-F]+/i)){return b}var d;if(b.substr(0,4)==="rgb("){d=b}else{var c=$("<div></div>").appendTo("#thePage");c.css("color",b);d=window.getComputedStyle(c[0]).color;c.remove()}var a="#";d.split(",").forEach(function(g,e){if(e>=3){return}var f=parseInt(g.replace(/[^0-9\.]/g,"").trim()).toString(16);while(f.length<2){f="0"+f}a+=f});return a}function IsNullOrEmpty(b){if(typeof b==="undefined"||b===null){return true}else{if(typeof b==="string"){return b===""}else{if($.isArray(b)){return b.length===0}else{if($.isPlainObject(b)){return $.isEmptyObject(b)}}}}return false}function ToggleExpandableSet(b){var f=event;var d=$(b).closest("._sys_expandable");if(d.hasClass("disabled")){return}var a=d.find(" > ._sys_expandable_content");var c=d.attr("data-in-ll");if(((!$(f.target)[0].hasAttribute("ctrl_type")&&$(f.target).hasClass("form-group"))||$(f.target).is("[readonly]")||$(f.target).is("[disabled]")||$(f.target).attr("ctrl_type")=="text"||f.currentTarget==f.target)||$(f.target).parent().hasClass("_sys_expandable_toggle")){if(d.hasClass("open")){a.slideUp(200);d.removeClass("open");d.trigger("hidden.bs.collapse")}else{if(c=="true"){d.closest(".list-group").find("._sys_expandable.open").each(function(g,e){CloseExpandableSet($(e).attr("id"))})}a.slideDown(200);d.addClass("open");RecalcControls(a);d.trigger("shown.bs.collapse")}}}function OpenExpandableSet(b){var c=$("#"+b);var a=$(c.find("._sys_expandable_content")[0]);if(!c.hasClass("open")){c.addClass("open");a.slideDown(200);RecalcControls(c,false);c.trigger("shown.bs.collapse")}}function CloseExpandableSet(b){var c=$("#"+b);var a=$(c.find("._sys_expandable_content")[0]);if(c.hasClass("open")){c.removeClass("open");a.slideUp(200);c.trigger("hidden.bs.collapse")}}function GetLanguage(){return $("html").attr("lang")||g_TopFrame.g_defaultLanguage||"en"}function SetLanguage(d){var c=d||g_TopFrame.g_defaultLanguage;if(!c.match(/^[A-Za-z]{1,16}$/)){return}if(c===GetLanguage()){return}var a=$("html");var b=[];if(a.data("dictionary")&&a.data("dictionary")[c]){b=a.data("dictionary")[c]}$.each(b,function(f,g){if(g===undefined){return}var e=f.lastIndexOf(".");if(e<0){return}SetControlProp(f.substring(0,e),f.substring(e+1),g)});if(g_TopFrame.g_Localization[d]){g_LocalizedStrings=g_TopFrame.g_Localization[d];g_IsRequiredField=g_LocalizedStrings.REQUIRED_FIELD;g_DateTimeSettings=g_LocalizedStrings;$("div.invalidation_message").not(":empty").text(g_IsRequiredField);$('[ctrl_type="layout_list"][data-paginating]').each(function(){LayoutListApplyPagination($(this).attr("id"))})}else{RunTimeError("SetLanguage(): language not found",d)}if($('div[ctrl_type="ctr-calendar"]').length>0){$('div[ctrl_type="ctr-calendar"]').fullCalendar("option","locale",d)}a.attr("lang",c);$(g_TopFrame.document).children("html").attr("lang",d);if(window.sessionStorage){window.sessionStorage.setItem("language",d)}}function GetLocalizedText(c){var d=null;var b=GetLanguage();var a=$("html");if(a.data("dictionary")&&a.data("dictionary")[b]){d=a.data("dictionary")[b][c]}return d||c||""}function InitMap(b,a){let mapType=b.getAttribute("data-type");if(!a){b.gMap=new google.maps.Map(b,{center:{lat:-34.397,lng:150.644},zoom:1,mapTypeId:mapType});return}if(mapType==="streetview"){InitStreetView(a,b.id)}else{b.gMap=new google.maps.Map(b,{mapTypeId:mapType});SetControlProp(b.id,"locations",a)}}function convertStringLocation(a){return{address:a,heading:0,pitch:0}}function convertObjectLocationParameters(a){return{address:a.address,latitude:a.latitude,longitude:a.longitude,heading:((a.heading==null)||isNaN(a.heading))?0:a.heading,pitch:((a.pitch==null)||isNaN(a.pitch))?0:a.pitch,infowindow:a.infowindow,markertype:a.markertype}}function getFirstValidLocationForStreetview(a){let i=0;while(!a[i]&&a.length!==0){a.splice(i,1)}return a[i]}function removeEmptyLocationItems(a){let i=0;let addressList=[];while(i<a.length){if(typeof a[i]==="string"){addressList.push({address:a[i]})}else{if(typeof a[i]==="object"&&a[i]){addressList.push(a[i])}}i++}if(addressList.length>0){return addressList}}function storeGeocode(b,a){window.sessionStorage.setItem(b,JSON.stringify(a))}function getGeocode(a){return JSON.parse(window.sessionStorage.getItem(a))}let overQueryCount=0;function getAddress(a,h,f,b,e,d,c){let storedLocation=getGeocode(a);if(storedLocation){SetMarkers(storedLocation,h,f,b,e,d,c)}else{const g=new google.maps.Geocoder();g.geocode({address:a},function(k,j){if(j===google.maps.GeocoderStatus.OK){HideSpinner();let location=k[0].geometry.location;storeGeocode(a,location);SetMarkers(location,h,f,b,e,d,c)}else{if(j===google.maps.GeocoderStatus.OVER_QUERY_LIMIT){ShowSpinner();overQueryCount++;setTimeout(function(){getAddress(a,h,f,b,e,d,c)},overQueryCount*10);setTimeout(function(){HideSpinner()},overQueryCount*10)}else{if(j===google.maps.GeocoderStatus.ERROR){RunTimeError("The Geocoder service replied an error.")}}}})}}function SetMarkers(a,g,f,b,e,d,c){if(!g||g.mapTypeId==="streetview"){InitStreetView(e,b);return}let info;if(a.hasOwnProperty("latitude")&&a.hasOwnProperty("longitude")){if(a.infowindow){info=a.infowindow}a=new google.maps.LatLng(a.latitude,a.longitude)}if(e.markertype){e.markertype="get_image.php?img="+e.markertype}let marker=new google.maps.Marker({map:g,position:a,animation:f==="TRUE"?google.maps.Animation.DROP:null,icon:e.markertype,id:b,order:c});if(e&&e.infowindow&&typeof e.infowindow=="string"){marker.infowindow=new google.maps.InfoWindow({content:e.infowindow});marker.addListener("click",function(){this.infowindow.open(this.map,this)})}if(info&&typeof info=="string"){marker.infowindow=new google.maps.InfoWindow({content:info});marker.addListener("click",function(){this.infowindow.open(this.map,this)})}g.markers.push(marker);let customZoom=parseInt(g.getDiv().getAttribute("data-zoom"));if(customZoom!==0){let lastMarker=getLastMarker(g.markers);g.setZoom(customZoom);g.setCenter(lastMarker.getPosition())}else{d.extend(marker.position);if(g.markers.length===1){g.setZoom(g.defaultZoom)}else{g.fitBounds(d);g.panToBounds(d);g.setZoom(g.zoom)}g.setCenter(d.getCenter())}}function getLastMarker(a){let lastMarker=a[0];for(let i=1;i<a.length;i++){if(a[i].order>lastMarker.order){lastMarker=a[i]}}return lastMarker}function InitStreetView(b,a){if(b instanceof Array){b=getFirstValidLocationForStreetview(b)}if(typeof b==="object"&&!b.length){b=convertObjectLocationParameters(b)}else{if(typeof b==="string"){b=convertStringLocation(b)}}if(b.latitude!=null&&b.longitude!=null){document.getElementById(a).gMap=new google.maps.StreetViewPanorama(document.getElementById(a),{mapTypeId:"streetview",position:{lat:b.latitude,lng:b.longitude},pov:{heading:b.heading,pitch:b.pitch},zoom:parseInt(document.getElementById(a).getAttribute("data-zoom"))})}else{if(b.address){let geocoder=new google.maps.Geocoder();geocoder.geocode({address:b.address},function(d,c){if(c===google.maps.GeocoderStatus.OK){HideSpinner();document.getElementById(a).gMap=new google.maps.StreetViewPanorama(document.getElementById(a),{mapTypeId:"streetview",position:{lat:d[0].geometry.location.lat(),lng:d[0].geometry.location.lng()},pov:{heading:b.heading,pitch:b.pitch},zoom:parseInt(document.getElementById(a).getAttribute("data-zoom"))})}else{if(c===google.maps.GeocoderStatus.OVER_QUERY_LIMIT){ShowSpinner();overQueryCount++;b={address:b.address};setTimeout(function(){InitStreetView(b,a)},overQueryCount*10);setTimeout(function(){HideSpinner()},overQueryCount*10)}else{if(c===google.maps.GeocoderStatus.ERROR){RunTimeError("The Geocoder service replied an error.")}}}})}}}function DoLogin(b,d,e,c,a,f,g){SecureAJAX("log_in.php",{data:{user:b,pass:d},dataType:"json",timeout:a*1000,success:function(h){if(h){if(g){g_TopFrame.location.href="../index.php?page_id="+g}else{g_TopFrame.location.reload(false)}}else{e()}},error:function(h,k,j){AjaxError("DoLogin",h,k,j);if(k==="timeout"){f()}else{c(h)}}})}function DoLogout(a){SecureAJAX("log_out.php",{dataType:"json",success:function(){sessionStorage.clear();g_TopFrame.location.href="../index.php"+(a?"?page_id="+a:"")}})}function DoSocialAction(b,c){var a={facebook:"social_actions/action_by_facebook.php",google:"social_actions/action_by_google.php",twitter:"social_actions/action_by_twitter.php",linkedin:"social_actions/action_by_linkedin.php"};SecureAJAX(a[b],{data:{current_location:g_TopFrame.location.href,social_action:c},dataType:"json",success:function(d){if(typeof d.loginUrl!="undefined"){g_TopFrame.location.href=d.loginUrl}else{if(typeof d.errorMsg!="undefined"){const e=new URL(g_TopFrame.location.href);e.searchParams.set("error",d.errorMsg);g_TopFrame.location.href=e.href}else{DoConsoleLog(d)}}},error:function(d){DoConsoleLog(d)}})}function GetTimeoutSettings(){return g_TopFrame.cTimeoutSettings}function OnError401(){if(g_LocalizedStrings.PROCESS_NOT_AUTHORIZED_CONTENT){MessageDlg("",g_LocalizedStrings.PROCESS_NOT_AUTHORIZED_TITLE||"",g_LocalizedStrings.PROCESS_NOT_AUTHORIZED_CONTENT,"O",{onOK:function(){g_TopFrame.onbeforeunload=null;DoGetPage(g_TopFrame.cTimeoutSettings.sysLogoutID,"M")}},{btnOK:g_LocalizedStrings.PROCESS_NOT_AUTHORIZED_BUTTON||"OK"},null,"default")}else{g_TopFrame.onbeforeunload=null;DoGetPage(g_TopFrame.cTimeoutSettings.sysLogoutID,"M")}}function OnSuggestionPanelClicked(){var a=$(this);$("#"+a.attr("data-for")).val(a.text());a.closest("ul").remove()}function OnSuggestionPanelKeydown(){var e=$(this).parent(),a=e.children("ul"),c=e.find("li"),b=c.filter(".active"),d=e.children("input");switch(event.keyCode){case 13:if(b.length>0){a.remove();d.val(b.text())}break;case 27:a.remove();break;case 38:if(b.length==0){c.last().addClass("active")}else{b.removeClass("active").prev().addClass("active")}break;case 40:if(b.length==0){c.first().addClass("active")}else{b.removeClass("active").next().addClass("active")}break}}function OnSuggestionInputBoxFocused(){$(this).parent().find("ul").show()}function OnSuggestionInputBoxBlurred(){var a=$(this);window.setTimeout(function(){a.parent().find("ul").hide()},20)}function DS_DeleteOneRecord(b,c,a){MessageDlg("Confirmation","",'Are you sure to delete the "'+c+'" record?',"YN",{onYes:function(){DoAjaxCall2("editor_ops.php",{op:"ds_delete_one_record",DataSetID:b,RecordID:c},"POST",function(){a.remove().draw()},function(d){MessageDlg("Warning","Operation failed.",GetFieldOfObject("responseText",d,false),"O",{},{},"","")},null,0,function(){MessageDlg("Warning","Operation timed out.","Try again.","O",{},{},"","")},null)}},{btnYes:"Delete",btnNo:"Cancel"},"","");return false}function IsPushEnabled(b,e,c){if(!("serviceWorker" in navigator&&"Notification" in window&&navigator.userAgent.indexOf("Edg")<0)){c&&c();return}var a=b,d=e;navigator.serviceWorker.getRegistrations().then(function(f){if(f.length>0){a&&a()}else{d&&d()}},e)}function EnablePush(a,b){if(!("serviceWorker" in navigator)){b("Service workers are not supported by this browser.");return}if(!("Notification" in window)){b("Notifications are not supported by this browser.");return}if(!(g_TopFrame.g_PushPublicKey)){b("Push public key is not configured.");return}if(navigator.userAgent.indexOf("Edg")>=0){b("Edge browser is not supported yet.");return}Notification.requestPermission().then(function(c){if(c==="granted"){navigator.serviceWorker.getRegistrations().then(function(d){if(d.length>0){d[0].unregister()}}).then(function(){navigator.serviceWorker.register(g_RepoRelURL+"sw.js?_="+(new Date()).valueOf()+"&key="+g_TopFrame.g_PushPublicKey).then(a,b)},b)}else{b&&b()}})}function DisablePush(){if(!navigator.serviceWorker){return}navigator.serviceWorker.getRegistrations().then(function(a){if(a.length>0){a[0].unregister()}})}function GetCurrentPosition(b,a,c){if(!navigator.geolocation){c()}navigator.geolocation.getCurrentPosition(function(d){var e=d.coords;b([e.latitude,e.longitude])},function(d){if(d.code===d.PERMISSION_DENIED){c()}else{a()}})}function GetSelectedRowNumber(d){var b=$("#"+d).DataTable();if(b.settings()[0]._select.style!=="single"){return 0}var c=b.rows({selected:true});var a=c.indexes().toArray();if(a.length===1){return 1+a[0]}else{return 0}};